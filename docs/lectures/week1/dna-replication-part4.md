---
sidebar_position: 4
title: DNAè¤‡è£½ã¯ã‚²ãƒãƒ ã®ã©ã“ã§å§‹ã¾ã‚‹ã®ã‹ï¼ˆãã®4ï¼šå®Ÿè·µã¨èª²é¡Œï¼‰
---

# DNAè¤‡è£½ã¯ã‚²ãƒãƒ ã®ã©ã“ã§å§‹ã¾ã‚‹ã®ã‹ï¼ˆãã®4ï¼šå®Ÿè·µã¨èª²é¡Œï¼‰

## ğŸ¯ å­¦ç¿’ç›®æ¨™

ã“ã®è¬›ç¾©ã§ã¯ã€ä»¥ä¸‹ã«ã¤ã„ã¦å­¦ã³ã¾ã™ï¼š

- GCã‚¹ã‚­ãƒ¥ãƒ¼ã®æ•°å­¦çš„å®šç¾©
- å¤§è…¸èŒã‚²ãƒãƒ ã§ã®å®Ÿè·µ
- ç†è«–ã¨ç¾å®Ÿã®ã‚®ãƒ£ãƒƒãƒ—
- ãƒŸã‚¹ãƒãƒƒãƒã‚’è¨±å®¹ã™ã‚‹é »å‡ºèªå•é¡Œ
- å®Ÿéš›ã®ã‚²ãƒãƒ è§£æã®è¤‡é›‘æ€§

## ğŸ“ GCã‚¹ã‚­ãƒ¥ãƒ¼ã®æ•°å­¦çš„ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

### æ­£å¼ãªå®šç¾©

```
Skew(k) = #G[0:k] - #C[0:k]
```

ã“ã“ã§ï¼š

- `k`ï¼šã‚²ãƒãƒ å†…ã®ä½ç½®
- `#G[0:k]`ï¼šä½ç½®0ã‹ã‚‰kã¾ã§ã®ã‚°ã‚¢ãƒ‹ãƒ³ï¼ˆGï¼‰ã®å€‹æ•°
- `#C[0:k]`ï¼šä½ç½®0ã‹ã‚‰kã¾ã§ã®ã‚·ãƒˆã‚·ãƒ³ï¼ˆCï¼‰ã®å€‹æ•°

### ã‚¹ã‚­ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ 

ã‚¹ã‚­ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã¯ã€Skew(k)ã‚’kã«å¯¾ã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ãŸã‚°ãƒ©ãƒ•ã§ã™ã€‚

```python
def plot_skew_diagram(genome):
    """
    ã‚²ãƒãƒ ã®ã‚¹ã‚­ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚’æç”»

    Args:
        genome: DNAé…åˆ—

    Returns:
        ã‚¹ã‚­ãƒ¥ãƒ¼å€¤ã®ãƒªã‚¹ãƒˆã¨ã‚°ãƒ©ãƒ•
    """
    skew = [0]

    for nucleotide in genome:
        if nucleotide == 'G':
            skew.append(skew[-1] + 1)
        elif nucleotide == 'C':
            skew.append(skew[-1] - 1)
        else:
            skew.append(skew[-1])

    # ã‚°ãƒ©ãƒ•ã‚’æç”»
    import matplotlib.pyplot as plt
    plt.figure(figsize=(12, 6))
    plt.plot(range(len(skew)), skew)
    plt.xlabel('ã‚²ãƒãƒ ä½ç½®')
    plt.ylabel('GCã‚¹ã‚­ãƒ¥ãƒ¼')
    plt.title('ã‚¹ã‚­ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ')
    plt.grid(True)
    plt.show()

    return skew
```

## ğŸ”¬ å¤§è…¸èŒã‚²ãƒãƒ ã§ã®å®Ÿè·µ

### ã‚¹ã‚­ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã®è¦³å¯Ÿ

å¤§è…¸èŒï¼ˆE. coliï¼‰ã®ã‚²ãƒãƒ ã§ã‚¹ã‚­ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹ã¨ã€ç¾ã—ã„ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç¾ã‚Œã¾ã™ï¼š

```mermaid
graph TB
    subgraph "å¤§è…¸èŒã®ã‚¹ã‚­ãƒ¥ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³"
        A[é–‹å§‹] --> B[å¾ã€…ã«æ¸›å°‘]
        B --> C[æœ€å°å€¤<br/>è¤‡è£½èµ·ç‚¹ï¼]
        C --> D[æ€¥æ¿€ã«å¢—åŠ ]
        D --> E[çµ‚äº†]
    end

    style C fill:#FFD700,stroke:#FF0000,stroke-width:3px
```

### è¤‡è£½èµ·ç‚¹ã®ç‰¹å®š

ã‚¹ã‚­ãƒ¥ãƒ¼ãŒï¼š

1. **æ¸›å°‘ã—ã¦ã„ãŸ**å¾Œã«
2. **æ€¥æ¿€ã«å¢—åŠ ã—å§‹ã‚ã‚‹**

ã“ã®è»¢æ›ç‚¹ãŒè¤‡è£½èµ·ç‚¹ï¼ˆOriCï¼‰ã§ã™ï¼

## ğŸ˜” ç†è«–ã¨ç¾å®Ÿã®ã‚®ãƒ£ãƒƒãƒ—

### äºˆæƒ³å¤–ã®çµæœ

å¤§è…¸èŒã®è¤‡è£½èµ·ç‚¹ã‚’ç‰¹å®šã—ãŸå¾Œã€ãã®é ˜åŸŸã§é »å‡ºèªã‚’æ¢ã™ã¨...

> **é©šãã®çµæœ**ï¼š3å›ä»¥ä¸Šå‡ºç¾ã™ã‚‹é »å‡ºèªãŒå­˜åœ¨ã—ãªã„ï¼

```python
def analyze_ecoli_ori(ori_region, k=9):
    """
    å¤§è…¸èŒã®è¤‡è£½èµ·ç‚¹é ˜åŸŸã‚’åˆ†æ

    Args:
        ori_region: è¤‡è£½èµ·ç‚¹å‘¨è¾ºã®é…åˆ—
        k: k-merã®é•·ã•

    Returns:
        é »å‡ºèªã¨ãã®å‡ºç¾å›æ•°
    """
    pattern_count = {}

    for i in range(len(ori_region) - k + 1):
        pattern = ori_region[i:i+k]
        pattern_count[pattern] = pattern_count.get(pattern, 0) + 1

    # 3å›ä»¥ä¸Šå‡ºç¾ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¢ã™
    frequent = {p: c for p, c in pattern_count.items() if c >= 3}

    if not frequent:
        print("é »å‡ºèªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ï¼")

    return frequent
```

## ğŸ¤” ãªãœå¤±æ•—ã—ãŸã®ã‹ï¼Ÿ

### å¯èƒ½æ€§1ï¼šä½ç½®ã®ä¸æ­£ç¢ºã•

ã‚¹ã‚­ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ãŒç¤ºã™ä½ç½®ãŒã€å®Ÿéš›ã®è¤‡è£½èµ·ç‚¹ã¨å®Œå…¨ã«ä¸€è‡´ã—ãªã„å¯èƒ½æ€§ï¼š

- ã‚¹ã‚­ãƒ¥ãƒ¼æœ€å°å€¤ã¯ã€ŒãŠãŠã‚ˆãã®ã€ä½ç½®
- å®Ÿéš›ã®è¤‡è£½èµ·ç‚¹ã¯è¿‘å‚ã«ã‚ã‚‹

### å¯èƒ½æ€§2ï¼šéš ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¤‡é›‘æ€§

DnaAãƒœãƒƒã‚¯ã‚¹ãŒç§ãŸã¡ãŒæƒ³å®šã—ã¦ã„ãŸã‚ˆã‚Šã€Œã¨ã‚‰ãˆã©ã“ã‚ãŒãªã„ã€å¯èƒ½æ€§ï¼š

- å®Œå…¨ä¸€è‡´ã™ã‚‹é »å‡ºèªã ã‘ã§ã¯ä¸ååˆ†
- ã‚ˆã‚Šå¾®å¦™ãªãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå­˜åœ¨

## ğŸ’¡ æ–°ãŸãªç™ºè¦‹ï¼šãƒŸã‚¹ãƒãƒƒãƒã®é‡è¦æ€§

### ã‚³ãƒ¬ãƒ©èŒã§ã®è¦³å¯Ÿ

ã‚³ãƒ¬ãƒ©èŒã®è¤‡è£½èµ·ç‚¹ã‚’å†åº¦è©³ã—ãè¦³å¯Ÿã™ã‚‹ã¨ï¼š

```
æ¨™æº–çš„ãªDnaAãƒœãƒƒã‚¯ã‚¹: ATGATCAAG (6å›å‡ºç¾)

è¿½åŠ ã§ç™ºè¦‹ã•ã‚ŒãŸãƒ‘ã‚¿ãƒ¼ãƒ³:
- ATGATCAAC (1æ–‡å­—é•ã„)
- ATGATCAAA (1æ–‡å­—é•ã„)
```

### é‡è¦ãªæ´å¯Ÿ

> DnaAã‚¿ãƒ³ãƒ‘ã‚¯è³ªã¯å®Œç’§ãªDnaAãƒœãƒƒã‚¯ã‚¹ã ã‘ã§ãªãã€ã‚ãšã‹ã«ç•°ãªã‚‹ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚‚çµåˆã§ãã‚‹ï¼

```mermaid
graph LR
    A[DnaAã‚¿ãƒ³ãƒ‘ã‚¯è³ª] --> B[ATGATCAAG<br/>å®Œç’§ãªä¸€è‡´]
    A --> C[ATGATCAAC<br/>1æ–‡å­—é•ã„]
    A --> D[ATGATCAAA<br/>1æ–‡å­—é•ã„]

    style B fill:#90EE90
    style C fill:#FFE4B5
    style D fill:#FFE4B5
```

## ğŸ”§ ãƒŸã‚¹ãƒãƒƒãƒã‚’è¨±å®¹ã™ã‚‹é »å‡ºèªå•é¡Œ

### å•é¡Œå®šç¾©

**å…¥åŠ›**ï¼š

- ãƒ†ã‚­ã‚¹ãƒˆï¼ˆDNAé…åˆ—ï¼‰
- æ•´æ•°kï¼ˆk-merã®é•·ã•ï¼‰
- æ•´æ•°dï¼ˆè¨±å®¹ã™ã‚‹ãƒŸã‚¹ãƒãƒƒãƒæ•°ï¼‰

**å‡ºåŠ›**ï¼š

- æœ€å¤§då€‹ã®ãƒŸã‚¹ãƒãƒƒãƒã§æœ€ã‚‚é »ç¹ã«å‡ºç¾ã™ã‚‹k-mer

### ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¦‚è¦

```python
def frequent_words_with_mismatches(text, k, d):
    """
    ãƒŸã‚¹ãƒãƒƒãƒã‚’è¨±å®¹ã™ã‚‹é »å‡ºèªã‚’è¦‹ã¤ã‘ã‚‹

    Args:
        text: DNAé…åˆ—
        k: k-merã®é•·ã•
        d: è¨±å®¹ã™ã‚‹ãƒŸã‚¹ãƒãƒƒãƒæ•°

    Returns:
        æœ€é »å‡ºã®k-merã®ãƒªã‚¹ãƒˆ
    """
    patterns = []
    freq_map = {}

    # ã™ã¹ã¦ã®å¯èƒ½ãªk-merã‚’ç”Ÿæˆ
    for i in range(len(text) - k + 1):
        pattern = text[i:i+k]
        neighborhood = generate_neighborhood(pattern, d)

        for neighbor in neighborhood:
            if neighbor not in freq_map:
                freq_map[neighbor] = 0
            freq_map[neighbor] += 1

    # æœ€å¤§é »åº¦ã‚’è¦‹ã¤ã‘ã‚‹
    max_count = max(freq_map.values())

    # æœ€å¤§é »åº¦ã‚’æŒã¤ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åé›†
    for pattern, count in freq_map.items():
        if count == max_count:
            patterns.append(pattern)

    return patterns

def generate_neighborhood(pattern, d):
    """
    ãƒ‘ã‚¿ãƒ¼ãƒ³ã®d-neighborhoodã‚’ç”Ÿæˆ

    Args:
        pattern: å…ƒã®ãƒ‘ã‚¿ãƒ¼ãƒ³
        d: è¨±å®¹ã™ã‚‹ãƒŸã‚¹ãƒãƒƒãƒæ•°

    Returns:
        då€‹ä»¥ä¸‹ã®ãƒŸã‚¹ãƒãƒƒãƒã‚’æŒã¤ã™ã¹ã¦ã®ãƒ‘ã‚¿ãƒ¼ãƒ³
    """
    if d == 0:
        return [pattern]
    if len(pattern) == 1:
        return ['A', 'C', 'G', 'T']

    neighborhood = []
    suffix_neighbors = generate_neighborhood(pattern[1:], d)

    for text in suffix_neighbors:
        if hamming_distance(pattern[1:], text) < d:
            for nucleotide in ['A', 'C', 'G', 'T']:
                neighborhood.append(nucleotide + text)
        else:
            neighborhood.append(pattern[0] + text)

    return neighborhood

def hamming_distance(p, q):
    """ãƒãƒŸãƒ³ã‚°è·é›¢ã‚’è¨ˆç®—"""
    return sum(1 for i in range(len(p)) if p[i] != q[i])
```

## ğŸ‰ å¤§è…¸èŒã§ã®æˆåŠŸ

### ãƒŸã‚¹ãƒãƒƒãƒã‚’è€ƒæ…®ã—ãŸçµæœ

ãƒŸã‚¹ãƒãƒƒãƒã‚’è¨±å®¹ã™ã‚‹é »å‡ºèªå•é¡Œã‚’å¤§è…¸èŒã‚²ãƒãƒ ã«é©ç”¨ã™ã‚‹ã¨ï¼š

```python
# å¤§è…¸èŒã®è¤‡è£½èµ·ç‚¹å‘¨è¾ºã§å®Ÿè¡Œ
result = frequent_words_with_mismatches(ecoli_ori_region, k=9, d=1)

# çµæœï¼šã¨ã‚‰ãˆã©ã“ã‚ã®ãªã„é »å‡ºèªãŒç™ºè¦‹ã•ã‚ŒãŸï¼
# ã“ã‚Œã‚‰ãŒå®Ÿéš›ã®DnaAãƒœãƒƒã‚¯ã‚¹ã§ã‚ã‚‹ã“ã¨ãŒåˆ¤æ˜
```

## âš ï¸ ç¾å®Ÿä¸–ç•Œã®è¤‡é›‘æ€§

### æ®‹ã•ã‚ŒãŸèª²é¡Œ

1. **DnaAãƒœãƒƒã‚¯ã‚¹ãŒå°‘ãªã„ç´°èŒ**
   - ä¸€éƒ¨ã®ç´°èŒã§ã¯é »å‡ºèªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã¯è¦‹ã¤ã‘ã‚‰ã‚Œãªã„
   - ã‚ˆã‚Šæ´—ç·´ã•ã‚ŒãŸæ‰‹æ³•ãŒå¿…è¦

2. **è¤‡è£½çµ‚ç«¯ã®ä½ç½®**
   - è¤‡è£½èµ·ç‚¹ã®çœŸå‘ã‹ã„ã«ãªã„ã“ã¨ãŒå¤šã„
   - ã‚²ãƒãƒ æ§‹é€ ãŒã‚ˆã‚Šè¤‡é›‘

3. **è¤‡é›‘ãªã‚¹ã‚­ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ **
   - å¤§è…¸èŒã®ã‚ˆã†ãªå˜ç´”ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ç¨€
   - è¤‡æ•°ã®è¦å› ãŒå½±éŸ¿

```mermaid
graph TD
    A[ç†æƒ³çš„ãªä¸–ç•Œ] --> B[å˜ç´”ãªã‚¹ã‚­ãƒ¥ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³]
    A --> C[å¤šæ•°ã®å®Œå…¨ä¸€è‡´DnaAãƒœãƒƒã‚¯ã‚¹]
    A --> D[å¯¾ç§°çš„ãªè¤‡è£½]

    E[ç¾å®Ÿã®ä¸–ç•Œ] --> F[è¤‡é›‘ãªã‚¹ã‚­ãƒ¥ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³]
    E --> G[å°‘æ•°ã®ä¸å®Œå…¨ãªDnaAãƒœãƒƒã‚¯ã‚¹]
    E --> H[éå¯¾ç§°ãªè¤‡è£½]

    style A fill:#90EE90
    style E fill:#FFB6C1
```

## ğŸš€ ä»Šå¾Œã®æ–¹å‘æ€§

### ã‚ˆã‚Šé«˜åº¦ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

1. **æ©Ÿæ¢°å­¦ç¿’ã®æ´»ç”¨**
   - ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ã®æ”¹å–„
   - è¤‡é›‘ãªç‰¹å¾´ã®çµ±åˆ

2. **æ¯”è¼ƒã‚²ãƒãƒŸã‚¯ã‚¹**
   - è¤‡æ•°ã®ç¨®ã‚’æ¯”è¼ƒ
   - é€²åŒ–çš„ã«ä¿å­˜ã•ã‚ŒãŸé ˜åŸŸã®ç‰¹å®š

3. **å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã¨ã®çµ±åˆ**
   - ChIP-seqãƒ‡ãƒ¼ã‚¿ã®æ´»ç”¨
   - ç”ŸåŒ–å­¦çš„çŸ¥è¦‹ã®çµ„ã¿è¾¼ã¿

## ğŸ“Š ã¾ã¨ã‚

1. **GCã‚¹ã‚­ãƒ¥ãƒ¼ã¯å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«**
   - å¤§è…¸èŒã§ã¯ç¾ã—ãæ©Ÿèƒ½
   - è¤‡è£½èµ·ç‚¹ã®å¤§ã¾ã‹ãªä½ç½®ã‚’ç‰¹å®š

2. **å®Œå…¨ä¸€è‡´ã ã‘ã§ã¯ä¸ååˆ†**
   - ãƒŸã‚¹ãƒãƒƒãƒã‚’è¨±å®¹ã™ã‚‹å¿…è¦æ€§
   - ç”Ÿç‰©å­¦çš„ãªæŸ”è»Ÿæ€§ã‚’åæ˜ 

3. **ç†è«–ã¨å®Ÿè·µã®ã‚®ãƒ£ãƒƒãƒ—**
   - ç†æƒ³çš„ãªãƒ¢ãƒ‡ãƒ«ã¨ç¾å®Ÿã®é•ã„
   - ã‚ˆã‚Šæ´—ç·´ã•ã‚ŒãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®å¿…è¦æ€§

4. **ç¶™ç¶šçš„ãªæ”¹å–„**
   - ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ”¹è‰¯
   - æ–°ã—ã„ç”Ÿç‰©å­¦çš„çŸ¥è¦‹ã®çµ±åˆ

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

- [ãƒŸã‚¹ãƒãƒƒãƒé »å‡ºèªå•é¡Œã®è©³ç´°](../../algorithms/frequent-words-mismatches)
- [å®Ÿéš›ã®ã‚²ãƒãƒ è§£æ](../week2/real-genome-analysis)
- [é«˜åº¦ãªè¤‡è£½èµ·ç‚¹äºˆæ¸¬](../../algorithms/advanced-ori-prediction)

## ğŸ“š å‚è€ƒæ–‡çŒ®

- Mackiewicz, P., et al. (1999) "Where does bacterial replication start?"
- Freeman, J.M., et al. (1998) "Patterns of genome organization in bacteria"
- [Rosalind - Frequent Words with Mismatches](http://rosalind.info/problems/ba1i/)
