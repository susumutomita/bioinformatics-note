# ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®è§£èª­ï¼ˆè¶…è©³ç´°ç‰ˆï¼‰

## ğŸ¯ ã¾ãšã€ã“ã®è¬›ç¾©ã§ä½•ã‚’å­¦ã¶ã®ã‹

æœ€çµ‚ã‚´ãƒ¼ãƒ«ï¼š**è³ªé‡åˆ†æã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰å…ƒã®ãƒšãƒ—ãƒãƒ‰é…åˆ—ã‚’å®Œç’§ã«å¾©å…ƒã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ãƒã‚¹ã‚¿ãƒ¼**

ã§ã‚‚ã€ã¡ã‚‡ã£ã¨å¾…ã£ã¦ãã ã•ã„ã€‚è³ªé‡ã®æ•°å€¤ã®ç¾…åˆ—ã‹ã‚‰ã©ã†ã‚„ã£ã¦é…åˆ—ã‚’å¾©å…ƒã™ã‚‹ã®ï¼Ÿ
å®Ÿã¯ã€ã“ã‚Œã¯**æš—å·è§£èª­ã®ã‚ˆã†ãªãƒ‘ã‚ºãƒ«å•é¡Œ**ã§ã€ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§è§£ã‘ã‚‹ã‚“ã§ã™ï¼

## ğŸ¤” ã‚¹ãƒ†ãƒƒãƒ—0ï¼šãªãœç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰å§‹ã‚ã‚‹ã®ï¼Ÿ

### 0-1. ãã‚‚ãã‚‚ã®å•é¡Œã‚’è€ƒãˆã¦ã¿ã‚ˆã†

è³ªé‡åˆ†æè¨ˆã‹ã‚‰ã“ã‚“ãªãƒ‡ãƒ¼ã‚¿ãŒå‡ºã¦ããŸã¨ã—ã¾ã™ï¼š
`[0, 71, 114, 131, 185, 202, 245, 316]`

ã“ã‚Œã¯ä½•ã‚’æ„å‘³ã—ã¦ã„ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### 0-2. é©šãã®äº‹å®Ÿ

ã“ã‚Œã‚‰ã®æ•°å€¤ã¯ã€ãƒšãƒ—ãƒãƒ‰ã‚’æ§˜ã€…ãªä½ç½®ã§åˆ‡æ–­ã—ãŸ**æ–­ç‰‡ã®è³ªé‡**ãªã‚“ã§ã™ï¼
ãã—ã¦ã€ã“ã‚Œã‚‰ã®è³ªé‡ã®å·®ã‹ã‚‰å…ƒã®ã‚¢ãƒŸãƒé…¸é…åˆ—ãŒåˆ†ã‹ã‚‹ï¼

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—1ï¼šç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨ã¯ä½•ã‹

### 1-1. ã¾ãšç´ æœ´ãªç–‘å•ã‹ã‚‰

ã€Œç†æƒ³ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«ã£ã¦ã€ç¾å®Ÿã«ã¯å­˜åœ¨ã—ãªã„ã®ï¼Ÿ

### 1-2. ãªãœãã†ãªã‚‹ã®ã‹

ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¯**å…¨ã¦ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¨ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã®è³ªé‡ãŒå®Œç’§ã«æ¸¬å®šã•ã‚ŒãŸ**çŠ¶æ…‹ã€‚
ç¾å®Ÿã«ã¯ãƒã‚¤ã‚ºã‚„æ¬ æãŒã‚ã‚‹ãŸã‚ã€ã¾ãšç†æƒ³çš„ãªå ´åˆã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒé‡è¦ï¼

### 1-3. å…·ä½“ä¾‹ã§ç¢ºèª

```python
def generate_ideal_spectrum():
    """
    ãƒšãƒ—ãƒãƒ‰GAPã®ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’ç”Ÿæˆ
    """
    peptide = "GAP"
    masses = {'G': 57, 'A': 71, 'P': 97}

    print(f"ãƒšãƒ—ãƒãƒ‰: {peptide}")
    print("=" * 40)

    # ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹è³ªé‡
    print("\nãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆNæœ«ç«¯ã‹ã‚‰ï¼‰:")
    prefix_masses = [0]  # ç©ºã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹
    total = 0
    for i, aa in enumerate(peptide):
        total += masses[aa]
        prefix_masses.append(total)
        print(f"  {peptide[:i+1]:3s}: {total:3d}")

    # ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹è³ªé‡
    print("\nã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆCæœ«ç«¯ã‹ã‚‰ï¼‰:")
    suffix_masses = []
    for i in range(1, len(peptide) + 1):
        suffix = peptide[-i:]
        mass = sum(masses[aa] for aa in suffix)
        suffix_masses.append(mass)
        print(f"  {suffix:3s}: {mass:3d}")

    # ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«
    ideal_spectrum = sorted(set(prefix_masses + suffix_masses))
    print(f"\nç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«: {ideal_spectrum}")

    return ideal_spectrum

generate_ideal_spectrum()
```

### 1-4. ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆ

ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã«ã¯**é‡è¤‡ãŒãªã„**ï¼ˆsetã‚’ä½¿ç”¨ï¼‰ã€ãã—ã¦**ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹**ï¼

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—2ï¼šãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¨ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã®é­”æ³•

### 2-1. ãªãœä¸¡æ–¹å¿…è¦ãªã®ï¼Ÿ

```python
def why_both_fragments():
    """
    ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¨ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ä¸¡æ–¹ãŒå¿…è¦ãªç†ç”±
    """
    print("ãªãœä¸¡æ–¹ã®æ–­ç‰‡ãŒå¿…è¦ã‹:")
    print("=" * 40)

    peptide = "NQEL"

    print(f"\nãƒšãƒ—ãƒãƒ‰: {peptide}")
    print("\nãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã ã‘ã®å ´åˆ:")
    print("  N, NQ, NQE, NQEL")
    print("  â†’ æœ€åˆã‹ã‚‰ã®æƒ…å ±ã—ã‹ãªã„")

    print("\nã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚‚å«ã‚ã‚‹ã¨:")
    print("  L, EL, QEL ã‚‚åˆ†ã‹ã‚‹")
    print("  â†’ ã‚ˆã‚Šå¤šãã®æ‰‹ãŒã‹ã‚Šï¼")

    print("\né‡è¦ãªè¦³å¯Ÿ:")
    print("ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹è³ªé‡ + ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹è³ªé‡ = ãƒšãƒ—ãƒãƒ‰å…¨ä½“ã®è³ªé‡")
    print("ã“ã‚ŒãŒé‡è¦ãªåˆ¶ç´„æ¡ä»¶ã«ãªã‚‹ï¼")

why_both_fragments()
```

### 2-2. ã§ã‚‚å¾…ã£ã¦ã€ã©ã£ã¡ãŒãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‹åˆ†ã‹ã‚‰ãªã„

```python
def ambiguity_problem():
    """
    æ–­ç‰‡ã®ç¨®é¡ãŒä¸æ˜ãªå•é¡Œ
    """
    print("è³ªé‡åˆ†æã®æ ¹æœ¬çš„ãªå•é¡Œ:")
    print("=" * 40)

    print("\nè³ªé‡114ãŒæ¸¬å®šã•ã‚ŒãŸã¨ã—ã¦...")
    print("ã“ã‚Œã¯ï¼š")
    print("  â€¢ ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã€ŒNQã€ã®è³ªé‡ï¼Ÿ")
    print("  â€¢ ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã€ŒELã€ã®è³ªé‡ï¼Ÿ")
    print("  â€¢ åˆ¥ã®ãƒšãƒ—ãƒãƒ‰ã®æ–­ç‰‡ï¼Ÿ")

    print("\nç­”ãˆï¼šåˆ†ã‹ã‚‰ãªã„ï¼")
    print("â†’ ã ã‹ã‚‰å…¨ã¦ã®å¯èƒ½æ€§ã‚’è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹")

ambiguity_problem()
```

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—3ï¼šã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚°ãƒ©ãƒ• - å¤©æ‰çš„ãªç™ºæƒ³

### 3-1. ã‚°ãƒ©ãƒ•ã§è¡¨ç¾ã™ã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢

```python
def spectrum_graph_concept():
    """
    ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚°ãƒ©ãƒ•ã®åŸºæœ¬æ¦‚å¿µ
    """
    print("ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚°ãƒ©ãƒ•ã®æ§‹ç¯‰:")
    print("=" * 40)

    spectrum = [0, 57, 71, 128, 154, 185, 225, 242, 282, 299]

    print(f"\nã‚¹ãƒšã‚¯ãƒˆãƒ«: {spectrum}")

    print("\næ§‹ç¯‰ãƒ«ãƒ¼ãƒ«:")
    print("1. å„è³ªé‡å€¤ã‚’ãƒãƒ¼ãƒ‰ã«ã™ã‚‹")
    print("2. è³ªé‡å·®ãŒã‚¢ãƒŸãƒé…¸ã®è³ªé‡ã¨ä¸€è‡´ã—ãŸã‚‰ã‚¨ãƒƒã‚¸ã‚’å¼µã‚‹")
    print("3. ã‚¨ãƒƒã‚¸ã«ã‚¢ãƒŸãƒé…¸ã®ãƒ©ãƒ™ãƒ«ã‚’ä»˜ã‘ã‚‹")

    print("\nä¾‹ï¼š")
    print("  57 - 0 = 57 â†’ Gï¼ˆã‚°ãƒªã‚·ãƒ³ï¼‰")
    print("  128 - 57 = 71 â†’ Aï¼ˆã‚¢ãƒ©ãƒ‹ãƒ³ï¼‰")
    print("  225 - 128 = 97 â†’ Pï¼ˆãƒ—ãƒ­ãƒªãƒ³ï¼‰")

spectrum_graph_concept()
```

### 3-2. å®Ÿéš›ã®ã‚°ãƒ©ãƒ•æ§‹ç¯‰

```python
def build_spectrum_graph():
    """
    ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚°ãƒ©ãƒ•ã®å®Ÿè£…
    """
    import networkx as nx

    spectrum = [0, 57, 71, 128, 154, 185, 225, 242, 282, 299]

    # ã‚¢ãƒŸãƒé…¸è³ªé‡è¡¨
    aa_masses = {
        57: 'G', 71: 'A', 87: 'S', 97: 'P', 99: 'V',
        101: 'T', 103: 'C', 113: 'I/L', 114: 'N',
        115: 'D', 128: 'K/Q', 129: 'E', 131: 'M',
        137: 'H', 147: 'F', 156: 'R', 163: 'Y', 186: 'W'
    }

    print("ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚°ãƒ©ãƒ•ã®ã‚¨ãƒƒã‚¸:")
    print("=" * 40)

    edges = []
    for i, mass1 in enumerate(spectrum):
        for j, mass2 in enumerate(spectrum):
            if mass2 > mass1:
                diff = mass2 - mass1
                if diff in aa_masses:
                    edges.append((mass1, mass2, aa_masses[diff]))
                    print(f"  {mass1:3d} â†’ {mass2:3d}: {aa_masses[diff]} (å·®={diff})")

    return edges

build_spectrum_graph()
```

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—4ï¼šãƒ‘ã‚¹ã‹ã‚‰é…åˆ—ã¸

### 4-1. ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã‚·ãƒ³ã‚¯ã¸ã®é“

```python
def path_to_peptide():
    """
    ã‚°ãƒ©ãƒ•ã®ãƒ‘ã‚¹ã‹ã‚‰ãƒšãƒ—ãƒãƒ‰é…åˆ—ã‚’å¾©å…ƒ
    """
    print("ãƒ‘ã‚¹ã‹ã‚‰ãƒšãƒ—ãƒãƒ‰ã¸ã®å¤‰æ›:")
    print("=" * 40)

    # ä»®æƒ³çš„ãªãƒ‘ã‚¹
    path = [(0, 57, 'G'), (57, 128, 'A'), (128, 225, 'P')]

    print("\nãƒ‘ã‚¹:")
    for start, end, aa in path:
        print(f"  {start} â†’ {end}: {aa}")

    print("\nãƒšãƒ—ãƒãƒ‰é…åˆ—ã®æ§‹ç¯‰:")
    peptide = ""
    for _, _, aa in path:
        peptide += aa
        print(f"  ç¾åœ¨ã®é…åˆ—: {peptide}")

    print(f"\næœ€çµ‚é…åˆ—: {peptide}")

path_to_peptide()
```

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—5ï¼šãƒ‡ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆå˜ç´”ç‰ˆï¼‰

### 5-1. æœ€åˆã®è©¦ã¿

```python
def simple_decoding_algorithm():
    """
    å˜ç´”ãªãƒ‡ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
    """
    print("ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ‡ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆå˜ç´”ç‰ˆï¼‰:")
    print("=" * 50)

    print("""
    def decode_ideal_spectrum_simple(spectrum):
        # ã‚¹ãƒ†ãƒƒãƒ—1: ã‚°ãƒ©ãƒ•ã‚’æ§‹ç¯‰
        graph = build_spectrum_graph(spectrum)

        # ã‚¹ãƒ†ãƒƒãƒ—2: 0ã‹ã‚‰æœ€å¤§å€¤ã¸ã®ãƒ‘ã‚¹ã‚’æ¢ç´¢
        source = 0
        sink = max(spectrum)
        path = find_path(graph, source, sink)

        # ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ‘ã‚¹ã‹ã‚‰ãƒšãƒ—ãƒãƒ‰ã‚’æ§‹ç¯‰
        peptide = path_to_peptide(path)

        return peptide
    """)

    print("\nå•é¡Œç‚¹:")
    print("â€¢ è¤‡æ•°ã®ãƒ‘ã‚¹ãŒå­˜åœ¨ã™ã‚‹å¯èƒ½æ€§")
    print("â€¢ æ­£ã—ã„ãƒ‘ã‚¹ã‚’ã©ã†é¸ã¶ï¼Ÿ")

simple_decoding_algorithm()
```

### 5-2. ã§ã‚‚å¾…ã£ã¦ã€ã“ã‚Œã§æœ¬å½“ã«å‹•ãï¼Ÿ

```python
def algorithm_problem():
    """
    å˜ç´”ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å•é¡Œç‚¹
    """
    print("å˜ç´”ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å¤±æ•—ä¾‹:")
    print("=" * 40)

    print("\næœªçŸ¥ã®ãƒšãƒ—ãƒãƒ‰ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«:")
    spectrum = [0, 71, 101, 113, 114, 128, 184, 185, 199, 214, 227,
                256, 271, 298, 327, 328, 341, 369, 399, 428, 470]

    print(f"{spectrum[:5]}...")

    print("\nã‚°ãƒ©ãƒ•å†…ã®ã‚ã‚‹ãƒ‘ã‚¹: NTTAG")
    print("ã—ã‹ã—ã€NTTAGã®ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’è¨ˆç®—ã™ã‚‹ã¨...")
    print("å…ƒã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨ä¸€è‡´ã—ãªã„ï¼")

    print("\nåŸå› :")
    print("â€¢ ã‚°ãƒ©ãƒ•ã«ã¯å¤šãã®ãƒ‘ã‚¹ãŒå­˜åœ¨")
    print("â€¢ ãã®ä¸­ã®1ã¤ã ã‘ãŒæ­£è§£")
    print("â€¢ ã©ã®ãƒ‘ã‚¹ãŒæ­£ã—ã„ã‹åˆ†ã‹ã‚‰ãªã„")

algorithm_problem()
```

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—6ï¼šæ”¹è‰¯ç‰ˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### 6-1. å…¨ãƒ‘ã‚¹æ¢ç´¢ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

```python
def improved_decoding_algorithm():
    """
    æ”¹è‰¯ç‰ˆãƒ‡ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
    """
    print("ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ‡ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆæ”¹è‰¯ç‰ˆï¼‰:")
    print("=" * 50)

    print("""
    def decode_ideal_spectrum_improved(spectrum):
        # ã‚¹ãƒ†ãƒƒãƒ—1: ã‚°ãƒ©ãƒ•ã‚’æ§‹ç¯‰
        graph = build_spectrum_graph(spectrum)

        # ã‚¹ãƒ†ãƒƒãƒ—2: å…¨ã¦ã®ãƒ‘ã‚¹ã‚’æ¢ç´¢
        all_paths = find_all_paths(graph, 0, max(spectrum))

        # ã‚¹ãƒ†ãƒƒãƒ—3: å„ãƒ‘ã‚¹ã‚’æ¤œè¨¼
        for path in all_paths:
            peptide = path_to_peptide(path)

            # ãƒšãƒ—ãƒãƒ‰ã®ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’è¨ˆç®—
            computed_spectrum = compute_ideal_spectrum(peptide)

            # å…ƒã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨æ¯”è¼ƒ
            if computed_spectrum == spectrum:
                return peptide  # æ­£è§£ã‚’ç™ºè¦‹ï¼

        return None  # è§£ãªã—
    """)

improved_decoding_algorithm()
```

### 6-2. è¨ˆç®—é‡ã®å•é¡Œ

```python
def complexity_analysis():
    """
    ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¨ˆç®—é‡åˆ†æ
    """
    print("è¨ˆç®—é‡ã®åˆ†æ:")
    print("=" * 40)

    print("\nå•é¡Œã®ã‚µã‚¤ã‚º:")
    print("â€¢ n: ã‚¹ãƒšã‚¯ãƒˆãƒ«ä¸­ã®è³ªé‡æ•°")
    print("â€¢ m: å¯èƒ½ãªã‚¢ãƒŸãƒé…¸ã®ç¨®é¡ï¼ˆç´„20ï¼‰")

    print("\nã‚°ãƒ©ãƒ•ã®æ€§è³ª:")
    print(f"â€¢ ãƒãƒ¼ãƒ‰æ•°: O(n)")
    print(f"â€¢ ã‚¨ãƒƒã‚¸æ•°: O(nÂ²)")
    print(f"â€¢ ãƒ‘ã‚¹æ•°: æŒ‡æ•°é–¢æ•°çš„ï¼")

    print("\nå…¨ãƒ‘ã‚¹æ¢ç´¢ã®è¨ˆç®—é‡:")
    print("æœ€æ‚ªã®å ´åˆ: O(2^n)")
    print("â†’ æŒ‡æ•°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼")

    print("\næœ—å ±:")
    print("å®Ÿã¯å¤šé …å¼æ™‚é–“ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒå­˜åœ¨ã™ã‚‹")
    print("ï¼ˆå‹•çš„è¨ˆç”»æ³•ã‚’ä½¿ç”¨ï¼‰")

complexity_analysis()
```

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—7ï¼šç†æƒ³ã‹ã‚‰ç¾å®Ÿã¸

### 7-1. å®Ÿéš›ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®å•é¡Œ

```python
def real_spectrum_challenges():
    """
    å®Ÿéš›ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®èª²é¡Œ
    """
    print("å®Ÿéš›ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®å•é¡Œ:")
    print("=" * 40)

    print("\n1. æ¬ æè³ªé‡:")
    print("   â€¢ ä¸€éƒ¨ã®æ–­ç‰‡ãŒæ¤œå‡ºã•ã‚Œãªã„")
    print("   â€¢ ä½å¼·åº¦ã®ãƒ”ãƒ¼ã‚¯ãŒæ¶ˆãˆã‚‹")

    print("\n2. ãƒã‚¤ã‚ºè³ªé‡:")
    print("   â€¢ æ±šæŸ“ç‰©è³ªã®ãƒ”ãƒ¼ã‚¯")
    print("   â€¢ æ©Ÿå™¨ã®ãƒã‚¤ã‚º")
    print("   â€¢ äºˆæœŸã—ãªã„æ–­ç‰‡åŒ–")

    print("\n3. è³ªé‡èª¤å·®:")
    print("   â€¢ æ¸¬å®šã®ä¸æ­£ç¢ºã•")
    print("   â€¢ Â±0.5 Daç¨‹åº¦ã®èª¤å·®")

    print("\nçµæœ:")
    print("ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ä½¿ãˆãªã„ï¼")
    print("â†’ ã‚ˆã‚ŠæŸ”è»Ÿãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒå¿…è¦")

real_spectrum_challenges()
```

### 7-2. ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã®å¿…è¦æ€§

```python
def scoring_concept():
    """
    ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã«ã‚ˆã‚‹è§£æ±ºç­–
    """
    print("ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:")
    print("=" * 40)

    print("\nç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«:")
    print("  å®Œå…¨ä¸€è‡´ã‚’è¦æ±‚")
    print("  â—‹ã‹Ã—ã‹ã®äºŒæŠ")

    print("\nå®Ÿéš›ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«:")
    print("  ã€Œã©ã‚Œãã‚‰ã„è‰¯ãèª¬æ˜ã™ã‚‹ã‹ã€ã‚’ã‚¹ã‚³ã‚¢åŒ–")
    print("  æœ€é«˜ã‚¹ã‚³ã‚¢ã®ãƒšãƒ—ãƒãƒ‰ã‚’é¸æŠ")

    print("\nã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°åŸºæº–ã®ä¾‹:")
    print("  â€¢ ä¸€è‡´ã™ã‚‹è³ªé‡ã®æ•°")
    print("  â€¢ è³ªé‡èª¤å·®ã®åˆè¨ˆ")
    print("  â€¢ ãƒ”ãƒ¼ã‚¯å¼·åº¦ã®è€ƒæ…®")
    print("  â€¢ é€£ç¶šã™ã‚‹æ–­ç‰‡ã®å­˜åœ¨")

scoring_concept()
```

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—8ï¼šå®Ÿè£…ä¾‹

### 8-1. å®Œå…¨ãªå®Ÿè£…

```python
def complete_implementation():
    """
    ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ‡ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®å®Œå…¨å®Ÿè£…
    """
    def compute_prefix_masses(peptide, masses):
        """ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹è³ªé‡ã‚’è¨ˆç®—"""
        result = [0]
        total = 0
        for aa in peptide:
            total += masses.get(aa, 0)
            result.append(total)
        return result

    def compute_suffix_masses(peptide, masses):
        """ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹è³ªé‡ã‚’è¨ˆç®—"""
        result = []
        for i in range(1, len(peptide) + 1):
            suffix = peptide[-i:]
            mass = sum(masses.get(aa, 0) for aa in suffix)
            result.append(mass)
        return result

    def compute_ideal_spectrum(peptide, masses):
        """ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’è¨ˆç®—"""
        prefix = compute_prefix_masses(peptide, masses)
        suffix = compute_suffix_masses(peptide, masses)
        return sorted(set(prefix + suffix))

    # ãƒ†ã‚¹ãƒˆ
    masses = {'G': 57, 'A': 71, 'P': 97}
    peptide = "GAP"

    print(f"ãƒšãƒ—ãƒãƒ‰: {peptide}")
    print(f"ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«: {compute_ideal_spectrum(peptide, masses)}")

complete_implementation()
```

## ğŸ“ ã¾ã¨ã‚ï¼šä»Šæ—¥å­¦ã‚“ã ã“ã¨ã‚’æ•´ç†

### ãƒ¬ãƒ™ãƒ«1ï¼šè¡¨é¢çš„ç†è§£ï¼ˆã“ã‚Œã ã‘ã§ã‚‚OKï¼‰

- ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¯å…¨æ–­ç‰‡ã®è³ªé‡ã®é›†åˆ
- ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¨ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã®ä¸¡æ–¹ãŒå«ã¾ã‚Œã‚‹
- ã‚°ãƒ©ãƒ•ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§é…åˆ—ã‚’å¾©å…ƒã§ãã‚‹
- å®Ÿéš›ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã«ã¯ãƒã‚¤ã‚ºãŒã‚ã‚‹

### ãƒ¬ãƒ™ãƒ«2ï¼šæœ¬è³ªçš„ç†è§£ï¼ˆã“ã“ã¾ã§æ¥ãŸã‚‰ç´ æ™´ã‚‰ã—ã„ï¼‰

- ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚°ãƒ©ãƒ•ã®æ§‹ç¯‰æ–¹æ³•
- ãƒ‘ã‚¹æ¢ç´¢ã«ã‚ˆã‚‹é…åˆ—å¾©å…ƒ
- å…¨ãƒ‘ã‚¹æ¢ç´¢ã®å¿…è¦æ€§ã¨æ¤œè¨¼
- è¨ˆç®—é‡ã®å•é¡Œï¼ˆæŒ‡æ•°çš„ï¼‰

### ãƒ¬ãƒ™ãƒ«3ï¼šå¿œç”¨çš„ç†è§£ï¼ˆãƒ—ãƒ­ãƒ¬ãƒ™ãƒ«ï¼‰

- å‹•çš„è¨ˆç”»æ³•ã«ã‚ˆã‚‹å¤šé …å¼æ™‚é–“è§£æ³•
- ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã«ã‚ˆã‚‹å®Ÿã‚¹ãƒšã‚¯ãƒˆãƒ«å¯¾å¿œ
- è³ªé‡èª¤å·®ã®è¨±å®¹
- çµ±è¨ˆçš„æœ‰æ„æ€§ã®è©•ä¾¡

## ğŸ” ç·´ç¿’å•é¡Œ

```python
def practice_problems():
    """
    ç†è§£ã‚’æ·±ã‚ã‚‹ç·´ç¿’å•é¡Œ
    """
    print("ç·´ç¿’å•é¡Œ:")
    print("=" * 40)

    print("\nå•é¡Œ1: ãƒšãƒ—ãƒãƒ‰NQELã®ç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’è¨ˆç®—ã›ã‚ˆ")
    print("ï¼ˆN=114, Q=128, E=129, L=113ï¼‰")

    print("\nå•é¡Œ2: ã‚¹ãƒšã‚¯ãƒˆãƒ«[0, 87, 101, 188]ã‹ã‚‰")
    print("        å¯èƒ½ãªãƒšãƒ—ãƒãƒ‰ã‚’å…¨ã¦æ±‚ã‚ã‚ˆ")

    print("\nå•é¡Œ3: ãªãœç†æƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã§ã¯")
    print("        è¤‡æ•°ã®æ­£è§£ãŒå­˜åœ¨ã—ã†ã‚‹ã‹èª¬æ˜ã›ã‚ˆ")

    print("\nå•é¡Œ4: å®Ÿéš›ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã§æ¬ æè³ªé‡ãŒ")
    print("        ç™ºç”Ÿã™ã‚‹ç†ç”±ã‚’3ã¤æŒ™ã’ã‚ˆ")

practice_problems()
```

## ğŸš€ æ¬¡å›äºˆå‘Š

æ¬¡å›ã¯ã€Œ**ãƒšãƒ—ãƒãƒ‰ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ³ã‚°å•é¡Œ**ã€ã‚’å­¦ã³ã¾ã™ï¼

- å®Ÿéš›ã®ãƒã‚¤ã‚ºã ã‚‰ã‘ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«
- ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°é–¢æ•°ã®è¨­è¨ˆ
- å‹•çš„è¨ˆç”»æ³•ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

ç†æƒ³ã‹ã‚‰ç¾å®Ÿã¸ã€ã‚ˆã‚Šå®Ÿç”¨çš„ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é–‹ç™ºã—ã¾ã™ï¼

## å‚è€ƒæ–‡çŒ®

- Dancik, V. et al. (1999). "De novo peptide sequencing via tandem mass spectrometry"
- Chen, T. et al. (2001). "A dynamic programming approach to de novo peptide sequencing"
- Frank, A. & Pevzner, P. (2005). "PepNovo: de novo peptide sequencing"
