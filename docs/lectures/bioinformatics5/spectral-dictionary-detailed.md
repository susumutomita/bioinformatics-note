# ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ï¼šã‚µãƒ«ã¨çµ±è¨ˆå­¦è€…ãŒå‡ºä¼šã†ã¨ãï¼ˆè¶…è©³ç´°ç‰ˆï¼‰

## ğŸ¯ ã¾ãšã€ã“ã®è¬›ç¾©ã§ä½•ã‚’å­¦ã¶ã®ã‹

æœ€çµ‚ã‚´ãƒ¼ãƒ«ï¼š**ãƒšãƒ—ãƒãƒ‰åŒå®šã®çµ±è¨ˆçš„æœ‰æ„æ€§ã‚’è©•ä¾¡ã—ã€å½ç™ºè¦‹ã‚’é©åˆ‡ã«åˆ¶å¾¡ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹**

ã§ã‚‚ã€ã¡ã‚‡ã£ã¨å¾…ã£ã¦ãã ã•ã„ã€‚å‰å›ã€æç«œã®ãƒšãƒ—ãƒãƒ‰ã‚’è¦‹äº‹ã«åŒå®šã—ãŸã¨æ€ã£ãŸã®ã«ã€ä»Šåº¦ã¯ã€Œçµ±è¨ˆçš„æœ‰æ„æ€§ã€ï¼Ÿ
å®Ÿã¯ã€ã©ã‚“ãªã«é«˜ã‚¹ã‚³ã‚¢ã§ã‚‚ã€ãã‚ŒãŒã€Œæœ¬ç‰©ã€ã‹ã©ã†ã‹ã¯åˆ¥å•é¡Œãªã‚“ã§ã™ã€‚

## ğŸ¤” ã‚¹ãƒ†ãƒƒãƒ—0ï¼šãªãœçµ±è¨ˆçš„æœ‰æ„æ€§ã®è©•ä¾¡ãŒé‡è¦ãªã®ï¼Ÿ

### 0-1. ãã‚‚ãã‚‚ã®å•é¡Œã‚’è€ƒãˆã¦ã¿ã‚ˆã†

å‰å›ã®æç«œç ”ç©¶ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ã€‚T-Rexã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰27å€‹ã®ãƒšãƒ—ãƒãƒ‰ãŒåŒå®šã•ã‚Œã¾ã—ãŸã€‚
ã€Œç´ æ™´ã‚‰ã—ã„ï¼ æç«œã®æ­£ä½“ãŒåˆ¤æ˜ã—ãŸï¼ã€
...ã¨æ€ã£ãŸã‚‰å¤§é–“é•ã„ã§ã™ã€‚

### 0-2. é©šãã®äº‹å®Ÿ

å®Ÿã¯ã€è³ªé‡åˆ†æã®ä¸–ç•Œã«ã¯ã€Œå½é™½æ€§ã€ã¨ã„ã†æã‚ã—ã„æ•µãŒæ½œã‚“ã§ã„ã¾ã™ã€‚
é«˜ã‚¹ã‚³ã‚¢ã ã‹ã‚‰ã¨ã„ã£ã¦ã€å¿…ãšã—ã‚‚æ­£è§£ã¨ã¯é™ã‚‰ãªã„ã®ã§ã™ã€‚

ã¾ã•ã«ã€æ¨ç†å°èª¬ã§ã€Œå®Œç’§ãªã‚¢ãƒªãƒã‚¤ã€ã‚’æŒã¤å®¹ç–‘è€…ãŒå®Ÿã¯çŠ¯äººã ã£ãŸã€ã¨ã„ã†å±•é–‹ã¨åŒã˜ã§ã™ã­ã€‚

### 0-3. å…·ä½“çš„ãªå•é¡Œè¨­å®š

æƒ³åƒã—ã¦ã¿ã¦ãã ã•ã„ï¼š

- ãƒ’ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ã‹ã‚‰1,000å€‹ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’å–å¾—
- ãƒ’ãƒˆãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã«å¯¾ã—ã¦PSMæ¤œç´¢ã‚’å®Ÿè¡Œ
- é–¾å€¤ã‚’è¶…ãˆã‚‹100å€‹ã®PSMã‚’ç™ºè¦‹

**ã“ã“ã§é‡è¦ãªå•é¡Œ**ï¼šã“ã®100å€‹ã®ã†ã¡ã€ä½•ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆãŒé–“é•ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—1ï¼šãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã¨ã„ã†å¤©æ‰çš„ç™ºæƒ³

### 1-1. ã¾ãšç´ æœ´ãªç–‘å•ã‹ã‚‰

ã€Œã©ã†ã‚„ã£ã¦é–“é•ã„ã‚’è¦‹ã¤ã‘ã‚‹ã®ï¼Ÿæ­£è§£ãŒåˆ†ã‹ã‚‰ãªã„ã®ã«...ã€

ãã“ã§ç™»å ´ã™ã‚‹ã®ãŒã€Œãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ï¼ˆDecoy Proteomeï¼‰ã€ã¨ã„ã†é©å‘½çš„ãªã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã€‚

### 1-2. ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã¨ã¯ä½•ã‹

**ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ **ï¼š

- å®Ÿéš›ã®ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã¨åŒã˜ã‚µã‚¤ã‚º
- ã—ã‹ã—ã€å†…å®¹ã¯ **ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã•ã‚ŒãŸå½ç‰©**
- ã€Œæ­£è§£ã®ãªã„ãƒ†ã‚¹ãƒˆã€ã®ã‚ˆã†ãªã‚‚ã®

### 1-3. å®Ÿé¨“ã—ã¦ã¿ã¾ã—ã‚‡ã†

```python
def decoy_experiment():
    """
    ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ å®Ÿé¨“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    """
    # å®Ÿéš›ã®å®Ÿé¨“
    real_proteome = load_human_proteome()  # å®Ÿéš›ã®ãƒ’ãƒˆãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ 
    real_matches = psm_search(spectra, real_proteome, threshold=100)
    print(f"å®Ÿéš›ã®ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ : {len(real_matches)} PSM")

    # ãƒ‡ã‚³ã‚¤å®Ÿé¨“
    decoy_proteome = generate_random_proteome(size=len(real_proteome))
    decoy_matches = psm_search(spectra, decoy_proteome, threshold=100)
    print(f"ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ : {len(decoy_matches)} PSM")

    return real_matches, decoy_matches
```

### 1-4. ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆ

ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã§è¦‹ã¤ã‹ã£ãŸPSMã¯ã€**100%å½ç‰©**ã§ã™ã€‚
ãªãœãªã‚‰ã€å…ƒã€…æ­£è§£ã®ãªã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã ã‹ã‚‰ã§ã™ã€‚

ã“ã‚Œã¯ã€é–“é•ã„ã®æ•°ã‚’ç›´æ¥æ¸¬å®šã™ã‚‹ã€ã¾ã•ã«å¤©æ‰çš„ãªæ–¹æ³•ãªã®ã§ã™ï¼

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—2ï¼šå½ç™ºè¦‹ç‡ï¼ˆFDRï¼‰ã®æ¦‚å¿µ

### 2-1. ãƒ‡ã‚³ã‚¤å®Ÿé¨“ã®çµæœã‚’åˆ†æã—ã‚ˆã†

T-Rexç ”ç©¶ã®å®Ÿéš›ã®çµæœï¼š

- **å®Ÿéš›ã®UniProt+**ï¼š27å€‹ã®PSM
- **ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ **ï¼š1å€‹ã®PSM
- **é–¾å€¤**ï¼š100

### 2-2. FDRã®è¨ˆç®—æ–¹æ³•

**å½ç™ºè¦‹ç‡ï¼ˆFalse Discovery Rate, FDRï¼‰** ã®å®šç¾©ï¼š

```python
def calculate_fdr(real_matches, decoy_matches):
    """
    FDRã®è¨ˆç®—
    """
    fdr = len(decoy_matches) / len(real_matches)
    return fdr * 100  # ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸

# T-Rexç ”ç©¶ã®å ´åˆ
real_psms = 27
decoy_psms = 1
fdr = calculate_fdr(real_psms, decoy_psms)
print(f"FDR = {decoy_psms}/{real_psms} = {fdr:.1f}%")
```

çµæœï¼š**FDR = 1/27 = 3.7%**

### 2-3. ã¤ã¾ã‚Šã€è¨€ã„æ›ãˆã‚‹ã¨

FDRã¯ã€Œé–“é•ã„ã®å‰²åˆã€ã‚’è¡¨ã—ã¾ã™ã€‚

- FDR 3.7% = ç´„27å€‹ã®ã†ã¡1å€‹ãŒé–“é•ã„
- FDR 5% = 20å€‹ã®ã†ã¡1å€‹ãŒé–“é•ã„

### 2-4. ã“ã“ã§é‡è¦ãªè¦³å¯Ÿã‚’ã—ã¦ã¿ã¾ã—ã‚‡ã†

ã§ã‚‚ã€FDRãŒ3.7%ãªã‚‰ã€Œã‹ãªã‚Šè‰¯ã„çµæœã€ã¨æ€ã„ã¾ã›ã‚“ã‹ï¼Ÿ
å®Ÿã¯ã€ãã†å˜ç´”ã§ã¯ãªã„ã®ã§ã™...

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—3ï¼šå®Ÿé¨“å®¤æ±šæŸ“ã¨ã„ã†ç¾å®Ÿçš„ãªæ•µ

### 3-1. ã§ã‚‚ã€æœ¬å½“ã«T-Rexã®ãƒšãƒ—ãƒãƒ‰ãŒ27å€‹ï¼Ÿ

ã€Œç´ æ™´ã‚‰ã—ã„ï¼3.7%ã®èª¤å·®ã§27å€‹ã®æç«œãƒšãƒ—ãƒãƒ‰ã‚’ç™ºè¦‹ï¼ã€
...ã¨æ€ã£ãŸã‚‰ã€ç ”ç©¶è€…ã¯é¦–ã‚’æŒ¯ã‚Šã¾ã—ãŸã€‚

### 3-2. å®Ÿé¨“å®¤æ±šæŸ“ã®æ­£ä½“

å®Ÿã¯ã€åŒå®šã•ã‚ŒãŸãƒšãƒ—ãƒãƒ‰ã®å¤šãã¯ï¼š

- **ãƒ’ãƒˆã®çš®è†šç”±æ¥ã®ã‚±ãƒ©ãƒãƒ³**
- å®Ÿé¨“å™¨å…·ã®æ±šã‚Œ
- ç©ºæ°—ä¸­ã«æµ®éŠã™ã‚‹å¾®ç²’å­

### 3-3. é©šãã¹ãç¾å®Ÿ

ä»Šã€ã“ã®ç¬é–“ã«ã‚‚ï¼š

```
ã‚ãªãŸã®è‚Œã‹ã‚‰ â†’ ä½•ç™¾ä¸‡å€‹ã®å¾®ç²’å­ãŒå‰¥ãŒã‚Œè½ã¡ã‚‹
éƒ¨å±‹ã®ç©ºæ°—ä¸­ã« â†’ ã‚±ãƒ©ãƒãƒ³ã‚¿ãƒ³ãƒ‘ã‚¯è³ªãŒæµ®éŠ
è³ªé‡åˆ†æè£…ç½®ã« â†’ æ··å…¥ã—ã¦ã€Œå½ã®ã€ãƒ”ãƒ¼ã‚¯ã‚’ä½œã‚‹
```

### 3-4. å®Ÿé¨“ã—ã¦ã¿ã¾ã—ã‚‡ã†

æƒ³åƒã—ã¦ãã ã•ã„ï¼š

```python
identified_peptides = [
    ("GPPGPPGKNGDDGEAGKPGCP", "æç«œã‚³ãƒ©ãƒ¼ã‚²ãƒ³?", score=95),
    ("SCDCRRSQWSTNGKTIHCCDPR", "ã‚±ãƒ©ãƒãƒ³ï¼ˆå®Ÿé¨“å®¤æ±šæŸ“ï¼‰", score=88),
    ("LNAGDCSKSRSTSQSTSSYTC", "ã‚±ãƒ©ãƒãƒ³ï¼ˆå®Ÿé¨“å®¤æ±šæŸ“ï¼‰", score=85),
    ("GLPGPPGPPGKNGDDGEAGK", "é³¥ã‚³ãƒ©ãƒ¼ã‚²ãƒ³?", score=82),
    # ... æ®‹ã‚Š23å€‹
]

print("ã“ã®ä¸­ã§æœ¬å½“ã®æç«œãƒšãƒ—ãƒãƒ‰ã¯ä½•å€‹ï¼Ÿ")
```

### 3-5. æ–°ãŸãªèª²é¡Œã®ç™ºè¦‹

å…¨ä½“ã®FDRã§ã¯ãªãã€**å€‹åˆ¥ã®PSMã®çµ±è¨ˆçš„æœ‰æ„æ€§** ã‚’è©•ä¾¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã€Œã“ã®ç‰¹å®šã®ãƒšãƒ—ãƒãƒ‰åŒå®šã¯ä¿¡é ¼ã§ãã‚‹ã‹ï¼Ÿã€

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—4ï¼šå€‹åˆ¥PSMã®çµ±è¨ˆçš„æœ‰æ„æ€§è©•ä¾¡ã®å¿…è¦æ€§

### 4-1. æ–°ã—ã„å•é¡Œè¨­å®š

ã“ã‚Œã¾ã§ï¼šã€Œ100å€‹ã®PSMã®ã†ã¡5%ãŒé–“é•ã„ã€ï¼ˆå…¨ä½“ã®è©±ï¼‰
ã“ã‚Œã‹ã‚‰ï¼šã€Œã“ã®PSMã¯ä¿¡é ¼ã§ãã‚‹ã‹ï¼Ÿã€ï¼ˆå€‹åˆ¥ã®è©±ï¼‰

### 4-2. ãªãœå€‹åˆ¥è©•ä¾¡ãŒå¿…è¦ãªã®ã‹

ç†ç”±ã¯æ˜ç¢ºã§ã™ï¼š

```
ã‚±ãƒ©ãƒãƒ³æ±šæŸ“ãƒšãƒ—ãƒãƒ‰: ã‚¹ã‚³ã‚¢ 88 â†’ é–“é•ã„ãªãå½ç‰©
æç«œã‚³ãƒ©ãƒ¼ã‚²ãƒ³ãƒšãƒ—ãƒãƒ‰: ã‚¹ã‚³ã‚¢ 95 â†’ æœ¬ç‰©ã®å¯èƒ½æ€§ãŒé«˜ã„
```

åŒã˜FDRã§ã‚‚ã€å€‹åˆ¥ã®ä¿¡é ¼æ€§ã¯å…¨ãç•°ãªã‚Šã¾ã™ã€‚

### 4-3. ã§ã‚‚ã€ã©ã†ã‚„ã£ã¦å€‹åˆ¥è©•ä¾¡ã™ã‚‹ã®ï¼Ÿ

ã“ã“ã§ã€ã¾ã£ãŸãäºˆæƒ³å¤–ã®åŠ©ã£äººãŒç™»å ´ã—ã¾ã™...

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—5ï¼šã‚µãƒ«ã¨ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼ã®ç™»å ´

### 5-1. çªç„¶ã§ã™ãŒã€ã‚µãƒ«ã®è©±

æƒ³åƒã—ã¦ãã ã•ã„ï¼š

```
ğŸµ + âŒ¨ï¸ = ?

ã‚µãƒ«ã«ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼ã‚’æ¸¡ã—ã¦
ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚­ãƒ¼ã‚’å©ã‹ã›ã‚‹
é•·æ™‚é–“ç¶šã‘ã‚‹
```

### 5-2. å®Ÿé¨“çµæœã®ç™ºè¡¨

ã‚µãƒ«ãŒç”Ÿæˆã—ãŸæ–‡ç« ã‚’åˆ†æã—ãŸã¨ã“ã‚ï¼š

```
ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—: "asdfghqwertykjhgfd..."
ãã®ä¸­ã«å«ã¾ã‚Œã‚‹æ­£ã—ã„è‹±å˜èª: 13å€‹

å˜èªä¾‹:
- "cat" (å¶ç„¶ã®ä¸€è‡´)
- "the" (å¶ç„¶ã®ä¸€è‡´)
- "dog" (å¶ç„¶ã®ä¸€è‡´)
...
```

### 5-3. é‡è¦ãªç–‘å•

### ã‚µãƒ«ã¯è‹±èªã‚’è©±ã›ã‚‹ã®ã‹ï¼Ÿ

å½“ç„¶ã€ç­”ãˆã¯ã€ŒNOã€ã§ã™ã€‚ã“ã‚Œã‚‰ã¯ã™ã¹ã¦å¶ç„¶ã®ç”£ç‰©ã§ã™ã€‚

### 5-4. ã“ã“ã§é‡è¦ãªè¦³å¯Ÿã‚’ã—ã¦ã¿ã¾ã—ã‚‡ã†

ã§ã‚‚ã€**ãªãœ13å€‹ã‚‚æ­£ã—ã„å˜èªãŒã‚ã‚‹ã®ã‹ï¼Ÿ**
ãã—ã¦ã€**ã“ã®æ•°ã¯å¦¥å½“ãªã®ã‹ï¼Ÿ**

ã“ã‚Œã‚’èª¿ã¹ã‚‹ã«ã¯ã€Œ**ã‚µãƒ«ã¨ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼å•é¡Œ**ã€ã‚’è§£ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—6ï¼šè³ªé‡åˆ†æã¨ã®é©šãã¹ãé–¢é€£æ€§

### 6-1. å•é¡Œã®å®šå¼åŒ–

**ã‚µãƒ«ã¨ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼å•é¡Œ**ï¼š

- å…¥åŠ›ï¼šè¾æ›¸ã€ãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—ã®é•·ã•n
- å‡ºåŠ›ï¼šé•·ã•nã®ãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—ã«å«ã¾ã‚Œã‚‹è¾æ›¸å˜èªã®æœŸå¾…æ•°

### 6-2. ã§ã‚‚ã€è³ªé‡åˆ†æã¨ä½•ã®é–¢ä¿‚ãŒï¼Ÿ

å®Ÿã¯ã€è³ªé‡åˆ†æã«ã‚‚ã¾ã£ãŸãåŒã˜å•é¡ŒãŒã‚ã‚Šã¾ã™ï¼š

**é«˜ã‚¹ã‚³ã‚¢ãƒšãƒ—ãƒãƒ‰ã®æœŸå¾…æ•°å•é¡Œ**ï¼š

- å…¥åŠ›ï¼šã‚¹ãƒšã‚¯ãƒˆãƒ«ã€ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ é•·nã€ã‚¹ã‚³ã‚¢é–¾å€¤
- å‡ºåŠ›ï¼šé•·ã•nã®ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã§é–¾å€¤ä»¥ä¸Šã®ã‚¹ã‚³ã‚¢ã‚’æŒã¤ãƒšãƒ—ãƒãƒ‰ã®æœŸå¾…æ•°

### 6-3. é¡ä¼¼æ€§ã«æ°—ã¥ãã¾ã—ãŸã‹ï¼Ÿ

```python
# ã‚µãƒ«ã¨ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼
random_text = generate_random_text(length=n)
dictionary_words = find_dictionary_words(random_text, webster_dict)
expected_count = calculate_expected_words(n, webster_dict)

# è³ªé‡åˆ†æ
decoy_proteome = generate_random_proteome(length=n)
high_score_peptides = find_high_score_peptides(decoy_proteome, spectrum)
expected_count = calculate_expected_peptides(n, spectrum, threshold)
```

### 6-4. ã¤ã¾ã‚Šã€è¨€ã„æ›ãˆã‚‹ã¨

ä¸¡æ–¹ã¨ã‚‚ã€Œ**ãƒ©ãƒ³ãƒ€ãƒ ãªãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æœŸå¾…ã•ã‚Œã‚‹ä¸€è‡´æ•°**ã€ã‚’è¨ˆç®—ã™ã‚‹å•é¡Œãªã®ã§ã™ï¼

### 6-5. ã§ã‚‚å®Ÿã¯ã€ç¨®ã‚’æ˜ã‹ã™ã¨

ã“ã‚Œã‚‰ã¯æ•°å­¦çš„ã«**å®Œå…¨ã«åŒç­‰**ãªå•é¡Œã§ã™ã€‚

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—7ï¼šã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã«ã‚ˆã‚‹çµ±ä¸€çš„ç†è§£

### 7-1. æ–°ã—ã„æ¦‚å¿µã®å°å…¥

**ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ï¼ˆSpectral Dictionaryï¼‰**ï¼š
ç‰¹å®šã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã«å¯¾ã—ã¦ã€é–¾å€¤ä»¥ä¸Šã®ã‚¹ã‚³ã‚¢ã‚’æŒã¤ **ã™ã¹ã¦ã®ãƒšãƒ—ãƒãƒ‰ã®é›†åˆ**

```python
def create_spectral_dictionary(spectrum, threshold):
    """
    ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã®ç”Ÿæˆ
    """
    dictionary = []

    # ç†è«–ä¸Šã™ã¹ã¦ã®å¯èƒ½ãªãƒšãƒ—ãƒãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯
    for peptide in all_possible_peptides():
        score = calculate_score(peptide, spectrum)
        if score >= threshold:
            dictionary.append(peptide)

    return dictionary
```

### 7-2. å•é¡Œã®å†å®šå¼åŒ–

**å…ƒã®å•é¡Œ**ï¼š

- ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã§é–¾å€¤ä»¥ä¸Šã®ãƒšãƒ—ãƒãƒ‰æœŸå¾…æ•°ã‚’æ±‚ã‚ã‚‹

**æ–°ã—ã„å•é¡Œ**ï¼š

- ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã«å«ã¾ã‚Œã‚‹ã€Œã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã®å˜èªã€ã®æœŸå¾…æ•°ã‚’æ±‚ã‚ã‚‹

### 7-3. å®Œå…¨ãªç­‰ä¾¡æ€§ã®è¨¼æ˜

```python
# Step 1: ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã‚’ç”Ÿæˆ
spectral_dict = create_spectral_dictionary(spectrum, threshold)

# Step 2: å•é¡Œã‚’å†å®šå¼åŒ–
def expected_peptides_in_decoy(n, spectral_dict):
    """
    é•·ã•nã®ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã«å«ã¾ã‚Œã‚‹
    ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ãƒšãƒ—ãƒãƒ‰ã®æœŸå¾…æ•°
    """
    return calculate_expected_strings(n, spectral_dict)
```

### 7-4. ã“ã“ãŒã€Œé­”æ³•ã€ã®ã‚ˆã†ãªéƒ¨åˆ†ã§ã™

ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã«ã‚ˆã‚Šï¼š

- **ã‚µãƒ«ã¨ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼å•é¡Œ** = è¾æ›¸ã‹ã‚‰ã®å˜èªæœŸå¾…æ•°
- **è³ªé‡åˆ†æå•é¡Œ** = ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã‹ã‚‰ã®ãƒšãƒ—ãƒãƒ‰æœŸå¾…æ•°

ä¸¡è€…ãŒ **å®Œå…¨ã«åŒã˜æ•°å­¦çš„æ§‹é€ ** ã‚’æŒã¤ã“ã¨ãŒæ˜ç¢ºã«ãªã‚Šã¾ã—ãŸï¼

### 7-5. å®Ÿç”¨çš„ãªæ„å‘³

ã“ã‚Œã«ã‚ˆã‚Šï¼š

1. **ã‚µãƒ«ã¨ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼å•é¡Œ**ã®è§£æ³•ãŒãã®ã¾ã¾ä½¿ãˆã‚‹
2. çµ±è¨ˆå­¦ã®è±Šå¯ŒãªçŸ¥è­˜ã‚’æ´»ç”¨å¯èƒ½
3. å€‹åˆ¥PSMã®çµ±è¨ˆçš„æœ‰æ„æ€§ã‚’æ­£ç¢ºã«è©•ä¾¡ã§ãã‚‹

## ğŸ“– ã‚¹ãƒ†ãƒƒãƒ—8ï¼šå•é¡Œã®å®Œå…¨ãªå†å®šå¼åŒ–

### 8-1. æœ€çµ‚çš„ãªå•é¡Œè¨­å®š

**å…¥åŠ›**ï¼š

- ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã®ã™ã¹ã¦ã®ãƒšãƒ—ãƒãƒ‰
- ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ é•· n

**å‡ºåŠ›**ï¼š

- é•·ã•nã®ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã«ç¾ã‚Œã‚‹è¾æ›¸ãƒšãƒ—ãƒãƒ‰ã®æœŸå¾…æ•°

### 8-2. å®Ÿè£…ä¾‹

```python
def solve_spectral_dictionary_problem(spectrum, threshold, n):
    """
    ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸å•é¡Œã®è§£æ³•
    """
    # Step 1: ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã‚’æ§‹ç¯‰
    spectral_dict = create_spectral_dictionary(spectrum, threshold)
    print(f"ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã‚µã‚¤ã‚º: {len(spectral_dict)} ãƒšãƒ—ãƒãƒ‰")

    # Step 2: æœŸå¾…æ•°ã‚’è¨ˆç®—
    expected_count = 0
    for peptide in spectral_dict:
        probability = calculate_occurrence_probability(peptide, n)
        expected_count += probability

    return expected_count

# ä½¿ç”¨ä¾‹
spectrum = load_trex_spectrum()
n = 2_000_000  # UniProt+ã®ã‚µã‚¤ã‚º
expected = solve_spectral_dictionary_problem(spectrum, threshold=100, n)
print(f"æœŸå¾…ã•ã‚Œã‚‹å½é™½æ€§æ•°: {expected:.2f}")
```

### 8-3. çµ±è¨ˆçš„æœ‰æ„æ€§ã®è©•ä¾¡

```python
def evaluate_psm_significance(observed_psms, expected_false_positives):
    """
    PSMã®çµ±è¨ˆçš„æœ‰æ„æ€§è©•ä¾¡
    """
    if observed_psms <= expected_false_positives:
        return "çµ±è¨ˆçš„ã«æœ‰æ„ã§ã¯ãªã„ï¼ˆå¶ç„¶ã®å¯èƒ½æ€§å¤§ï¼‰"
    else:
        significance = observed_psms / expected_false_positives
        return f"çµ±è¨ˆçš„ã«æœ‰æ„ï¼ˆæœŸå¾…å€¤ã®{significance:.1f}å€ï¼‰"

# T-Rexç ”ç©¶ã¸ã®é©ç”¨
observed = 27
expected = 1.0  # ãƒ‡ã‚³ã‚¤å®Ÿé¨“ã‹ã‚‰æ¨å®š
result = evaluate_psm_significance(observed, expected)
print(result)
```

## ğŸ“ ã¾ã¨ã‚ï¼šä»Šæ—¥å­¦ã‚“ã ã“ã¨ã‚’æ•´ç†

### ãƒ¬ãƒ™ãƒ«1ï¼šè¡¨é¢çš„ç†è§£ï¼ˆã“ã‚Œã ã‘ã§ã‚‚OKï¼‰

- ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ ã§å½é™½æ€§ã®æ•°ã‚’æ¨å®šã§ãã‚‹
- FDRï¼ˆå½ç™ºè¦‹ç‡ï¼‰ã¯é–“é•ã„ã®å‰²åˆã‚’ç¤ºã™æŒ‡æ¨™
- å®Ÿé¨“å®¤æ±šæŸ“ãŒè³ªé‡åˆ†æã®å¤§ããªå•é¡Œ
- ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã¯é«˜ã‚¹ã‚³ã‚¢ãƒšãƒ—ãƒãƒ‰ã®é›†åˆ

### ãƒ¬ãƒ™ãƒ«2ï¼šæœ¬è³ªçš„ç†è§£ï¼ˆã“ã“ã¾ã§æ¥ãŸã‚‰ç´ æ™´ã‚‰ã—ã„ï¼‰

- ã‚µãƒ«ã¨ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼å•é¡Œã¨è³ªé‡åˆ†æã¯æ•°å­¦çš„ã«åŒç­‰
- ãƒ©ãƒ³ãƒ€ãƒ ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã®æœŸå¾…å€¤è¨ˆç®—ãŒçµ±è¨ˆçš„è©•ä¾¡ã®åŸºç¤
- å€‹åˆ¥PSMã®æœ‰æ„æ€§è©•ä¾¡ãŒå®Ÿç”¨ä¸Šé‡è¦
- ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã«ã‚ˆã‚Šå•é¡Œã‚’çµ±ä¸€çš„ã«ç†è§£å¯èƒ½

### ãƒ¬ãƒ™ãƒ«3ï¼šå¿œç”¨çš„ç†è§£ï¼ˆãƒ—ãƒ­ãƒ¬ãƒ™ãƒ«ï¼‰

- çµ±è¨ˆå­¦ã®ç†è«–ã‚’ç›´æ¥è³ªé‡åˆ†æã«å¿œç”¨ã§ãã‚‹ä»•çµ„ã¿
- æœŸå¾…å€¤è¨ˆç®—ã®æ•°å­¦çš„èƒŒæ™¯ã¨è¨ˆç®—è¤‡é›‘åº¦
- å®Ÿé¨“è¨­è¨ˆã«ãŠã‘ã‚‹çµ±è¨ˆçš„æ¤œå‡ºåŠ›ã®é‡è¦æ€§
- å¤šé‡æ¤œå®šå•é¡Œã¨FDRåˆ¶å¾¡ã®ç†è«–çš„åŸºç›¤

## ğŸš€ æ¬¡å›äºˆå‘Š

ã•ã‚‰ã«èˆˆå‘³æ·±ã„ç™ºå±•ãŒå¾…ã£ã¦ã„ã¾ã™ï¼
æ¬¡å›ã¯ã€Œ**æœŸå¾…å€¤è¨ˆç®—ã®å®Ÿéš›ã®æ•°å­¦**ã€ã«ã¤ã„ã¦è©³ã—ãå­¦ã³ã¾ã™ã€‚

ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ã®æœŸå¾…å€¤ã‚’å®Ÿéš›ã«ã©ã†è¨ˆç®—ã™ã‚‹ã®ã‹ï¼Ÿæ•°å­¦ã®ç¾ã—ã„ç†è«–ãŒã„ã‹ã«å®Ÿç”¨çš„ãªå•é¡Œè§£æ±ºã«å¨åŠ›ã‚’ç™ºæ®ã™ã‚‹ã‹ã‚’ä½“é¨“ã—ã¾ã—ã‚‡ã†ã€‚

ã¾ãŸã€**å¤šé‡æ¤œå®šè£œæ­£**ã®é‡è¦æ€§ã¨ã€ãªãœå˜ç´”ãªFDRã§ã¯ä¸ååˆ†ãªã®ã‹ã®æ·±ã„ç†ç”±ã‚‚æ˜ã‚‰ã‹ã«ã—ã¾ã™ã€‚ãŠæ¥½ã—ã¿ã«ï¼

---

## ä»Šæ—¥ã®ãƒã‚¤ãƒ³ãƒˆ

- ãƒ‡ã‚³ã‚¤ãƒ—ãƒ­ãƒ†ã‚ªãƒ¼ãƒ  = å½é™½æ€§ã®æ¤œå‡ºå™¨
- FDR = é–“é•ã„ã®å‰²åˆã®æŒ‡æ¨™
- å®Ÿé¨“å®¤æ±šæŸ“ = ç¾å®Ÿçš„ãªå¤§æ•µ
- ã‚µãƒ«ã¨ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼ = çµ±è¨ˆçš„é¡æ¨ã®å¤©æ‰çš„ç™ºæƒ³
- ã‚¹ãƒšã‚¯ãƒˆãƒ«è¾æ›¸ = çµ±ä¸€çš„ç†è§£ã®éµ
