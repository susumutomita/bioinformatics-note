---
sidebar_position: 2
---

# ç§»æ¤ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰è¦åˆ¶ãƒ¢ãƒãƒ¼ãƒ•ã¸ï¼ˆãƒ‘ãƒ¼ãƒˆ2ï¼‰

## ğŸ“– æ¦‚è¦

å‰å›ã®è¬›ç¾©ã§å­¦ã‚“ã ãƒ¢ãƒãƒ¼ãƒ•åˆ—æŒ™ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¯é™ç•ŒãŒã‚ã‚Šã¾ã—ãŸã€‚å®Ÿéš›ã®ç”Ÿç‰©å­¦çš„ãƒ‡ãƒ¼ã‚¿ã§ã¯ã€ã™ã¹ã¦ã®é…åˆ—ã«ãƒ¢ãƒãƒ¼ãƒ•ãŒå­˜åœ¨ã™ã‚‹ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚ã“ã®è¬›ç¾©ã§ã¯ã€ã‚ˆã‚Šç¾å®Ÿçš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã—ã¦ã€ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—ã¨ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°é–¢æ•°ã‚’ä½¿ã£ãŸæ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚

## ğŸ¯ å­¦ç¿’ç›®æ¨™

- ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—ï¼ˆMotifs Matrixï¼‰ã®ç†è§£
- ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹æ–‡å­—åˆ—ã®æ§‹ç¯‰
- ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°é–¢æ•°ã«ã‚ˆã‚‹è©•ä¾¡
- ãƒ¢ãƒãƒ¼ãƒ•ç™ºè¦‹å•é¡Œã®å®šå¼åŒ–
- è¨ˆç®—é‡ã®åˆ†æ

## ğŸ”„ å‰å›ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®é™ç•Œ

### å•é¡Œç‚¹

å‰å›ã®ãƒ¢ãƒãƒ¼ãƒ•åˆ—æŒ™ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã¯ï¼š

1. **ã™ã¹ã¦ã®é…åˆ—ã«ãƒ¢ãƒãƒ¼ãƒ•ãŒå­˜åœ¨ã™ã‚‹**ã¨ä»®å®š
2. ç”Ÿç‰©å­¦çš„ã«ã¯å¿…ãšã—ã‚‚æ­£ã—ããªã„
3. ä¸€éƒ¨ã®éºä¼å­ã«ã¯ãƒ¢ãƒãƒ¼ãƒ•ãŒæ¬ ã‘ã¦ã„ã‚‹å¯èƒ½æ€§

### æ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

ãƒ¢ãƒãƒ¼ãƒ•ã®é›†åˆã«å¯¾ã—ã¦**ã‚¹ã‚³ã‚¢ã‚’å‰²ã‚Šå½“ã¦ã‚‹**æ–¹æ³•ã‚’å°å…¥ã—ã¾ã™ã€‚

## ğŸ“Š ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—ï¼ˆMotifs Matrixï¼‰

### å®šç¾©

è¤‡æ•°ã®é…åˆ—ã‹ã‚‰é¸ã‚“ã k-merã®é›†åˆã‚’è¡Œåˆ—ã¨ã—ã¦è¡¨ç¾ï¼š

```
ä¾‹ï¼š8ã¤ã®é…åˆ—ã‹ã‚‰é¸ã‚“ã 15-merã®ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—

TCGGGGGTTTTT
CCGGTGACTTAC
ACGGGGATTTTC
TTGGGGACTTTT
AAGGGGACTTCC
TTGGGGACTTCC
TCGGGGATTCAT
TCGGGGATTTTC
```

### ä¿å­˜åº¦ã®åˆ†æ

å„åˆ—ã®ãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰ã®é »åº¦ã‚’è¨ˆç®—ï¼š

```python
def create_count_matrix(motifs):
    """
    ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—ã‹ã‚‰å„ä½ç½®ã®ãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰é »åº¦ã‚’è¨ˆç®—

    Args:
        motifs: ãƒ¢ãƒãƒ¼ãƒ•æ–‡å­—åˆ—ã®ãƒªã‚¹ãƒˆ

    Returns:
        ä½ç½®ã”ã¨ã®ãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰é »åº¦è¾æ›¸
    """
    k = len(motifs[0])
    count_matrix = []

    for j in range(k):
        column_counts = {'A': 0, 'C': 0, 'G': 0, 'T': 0}
        for motif in motifs:
            column_counts[motif[j]] += 1
        count_matrix.append(column_counts)

    return count_matrix
```

### ä¿å­˜æ€§ã®å¯è¦–åŒ–

**é«˜ä¿å­˜ä½ç½®**ï¼šã»ã¼ã™ã¹ã¦ã®é…åˆ—ã§åŒã˜ãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰

- ä¾‹ï¼š2,3ç•ªç›®ã®ä½ç½®ã§ã¯'G'ãŒå…¨é…åˆ—ã«å­˜åœ¨

**ä½ä¿å­˜ä½ç½®**ï¼šãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰ãŒã°ã‚‰ã¤ã

- ä¾‹ï¼šæœ€å¾Œã®ä½ç½®ã§ã¯è¤‡æ•°ã®ãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰ãŒæ··åœ¨

## ğŸ¨ ãƒ¢ãƒãƒ¼ãƒ•ãƒ­ã‚´

ãƒ¢ãƒãƒ¼ãƒ•ã®ä¿å­˜åº¦ã‚’è¦–è¦šçš„ã«è¡¨ç¾ã™ã‚‹æ–¹æ³•ï¼š

```mermaid
graph TD
    A[ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—] --> B[å„ä½ç½®ã®é »åº¦è¨ˆç®—]
    B --> C[æ–‡å­—ã®å¤§ãã•ã«å¤‰æ›]
    C --> D[ãƒ¢ãƒãƒ¼ãƒ•ãƒ­ã‚´]

    style A fill:#f9f,stroke:#333,stroke-width:2px
    style D fill:#9f9,stroke:#333,stroke-width:2px
```

- **æ–‡å­—ã®å¤§ãã•**ï¼šå‡ºç¾é »åº¦ã«æ¯”ä¾‹
- **é«˜ã•**ï¼šãã®ä½ç½®ã®ä¿å­˜åº¦ï¼ˆæƒ…å ±é‡ï¼‰ã‚’è¡¨ç¾

## ğŸ¯ ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹æ–‡å­—åˆ—

### å®šç¾©

ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—ã®å„åˆ—ã§æœ€ã‚‚é »å‡ºã™ã‚‹ãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰ã‚’é¸ã‚“ã§ä½œã‚‹æ–‡å­—åˆ—

```python
def consensus(motifs):
    """
    ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—ã‹ã‚‰ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹æ–‡å­—åˆ—ã‚’ç”Ÿæˆ

    Args:
        motifs: ãƒ¢ãƒãƒ¼ãƒ•æ–‡å­—åˆ—ã®ãƒªã‚¹ãƒˆ

    Returns:
        ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹æ–‡å­—åˆ—
    """
    k = len(motifs[0])
    consensus_string = ""

    for j in range(k):
        counts = {'A': 0, 'C': 0, 'G': 0, 'T': 0}
        for motif in motifs:
            counts[motif[j]] += 1

        # æœ€é »å‡ºãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰ã‚’é¸æŠï¼ˆåŒæ•°ã®å ´åˆã¯è¾æ›¸é †ï¼‰
        most_frequent = max(counts, key=counts.get)
        consensus_string += most_frequent

    return consensus_string

# ä¾‹
motifs = [
    "TCGGGGGTTTTT",
    "CCGGTGACTTAC",
    "ACGGGGATTTTC",
    "TTGGGGACTTTT"
]
print(consensus(motifs))  # "TCGGGGATTTTT"
```

## ğŸ“ ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°é–¢æ•°

### Score(Motifs)ã®å®šç¾©

ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—ã®ã‚¹ã‚³ã‚¢ = **ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹ã¨ä¸€è‡´ã—ãªã„æ–‡å­—ã®ç·æ•°**

```python
def score(motifs):
    """
    ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—ã®ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—
    ï¼ˆå°ã•ã„ã»ã©è‰¯ã„ï¼‰

    Args:
        motifs: ãƒ¢ãƒãƒ¼ãƒ•æ–‡å­—åˆ—ã®ãƒªã‚¹ãƒˆ

    Returns:
        ã‚¹ã‚³ã‚¢ï¼ˆä¸ä¸€è‡´ã®ç·æ•°ï¼‰
    """
    consensus_string = consensus(motifs)
    score = 0

    for motif in motifs:
        for i in range(len(motif)):
            if motif[i] != consensus_string[i]:
                score += 1

    return score
```

### ãƒãƒŸãƒ³ã‚°è·é›¢ã‚’ä½¿ã£ãŸè¡¨ç¾

ã‚¹ã‚³ã‚¢ã¯å„ãƒ¢ãƒãƒ¼ãƒ•ã¨ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹æ–‡å­—åˆ—é–“ã®ãƒãƒŸãƒ³ã‚°è·é›¢ã®ç·å’Œï¼š

```python
def hamming_distance(s1, s2):
    """2ã¤ã®æ–‡å­—åˆ—é–“ã®ãƒãƒŸãƒ³ã‚°è·é›¢"""
    return sum(c1 != c2 for c1, c2 in zip(s1, s2))

def score_with_hamming(motifs):
    """ãƒãƒŸãƒ³ã‚°è·é›¢ã‚’ä½¿ã£ãŸã‚¹ã‚³ã‚¢è¨ˆç®—"""
    consensus_string = consensus(motifs)
    return sum(hamming_distance(motif, consensus_string)
               for motif in motifs)
```

## ğŸ¯ ãƒ¢ãƒãƒ¼ãƒ•ç™ºè¦‹å•é¡Œ

### å•é¡Œã®å®šå¼åŒ–

**å…¥åŠ›ï¼š**

- æ•´æ•°kï¼ˆãƒ¢ãƒãƒ¼ãƒ•ã®é•·ã•ï¼‰
- æ•´æ•°tï¼ˆé…åˆ—ã®æ•°ï¼‰
- tå€‹ã®DNAé…åˆ—ï¼ˆãã‚Œãã‚Œé•·ã•nï¼‰

**å‡ºåŠ›ï¼š**

- Score(Motifs)ã‚’æœ€å°åŒ–ã™ã‚‹k-merã®é›†åˆ

### ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

```python
def brute_force_motif_search(dna_list, k):
    """
    ç·å½“ãŸã‚Šã§ãƒ¢ãƒãƒ¼ãƒ•ã‚’æ¢ç´¢

    Args:
        dna_list: DNAé…åˆ—ã®ãƒªã‚¹ãƒˆ
        k: ãƒ¢ãƒãƒ¼ãƒ•ã®é•·ã•

    Returns:
        æœ€é©ãªãƒ¢ãƒãƒ¼ãƒ•ã®ãƒªã‚¹ãƒˆ
    """
    import itertools

    best_motifs = []
    best_score = float('inf')

    # å„é…åˆ—ã‹ã‚‰å¯èƒ½ãªã™ã¹ã¦ã®k-merã‚’ç”Ÿæˆ
    all_kmers = []
    for dna in dna_list:
        kmers = [dna[i:i+k] for i in range(len(dna) - k + 1)]
        all_kmers.append(kmers)

    # ã™ã¹ã¦ã®çµ„ã¿åˆã‚ã›ã‚’è©¦ã™
    for motifs in itertools.product(*all_kmers):
        current_score = score(list(motifs))
        if current_score < best_score:
            best_score = current_score
            best_motifs = list(motifs)

    return best_motifs
```

## âš¡ è¨ˆç®—é‡ã®åˆ†æ

### ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã®è¨ˆç®—é‡

- **å¯èƒ½ãªãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—ã®æ•°**ï¼š(n - k + 1)^t
  - n: å„é…åˆ—ã®é•·ã•
  - k: ãƒ¢ãƒãƒ¼ãƒ•ã®é•·ã•
  - t: é…åˆ—ã®æ•°

- **å„è¡Œåˆ—ã®ã‚¹ã‚³ã‚¢è¨ˆç®—**ï¼šO(k Ã— t)

- **å…¨ä½“ã®è¨ˆç®—é‡**ï¼šO((n - k + 1)^t Ã— k Ã— t)

:::warningå®Ÿç”¨æ€§ã®å•é¡Œ
n = 1000, k = 15, t = 10ã®å ´åˆï¼š

- ç´„986^10 â‰ˆ 10^30é€šã‚Šã®çµ„ã¿åˆã‚ã›
- ç¾å®Ÿçš„ãªæ™‚é–“ã§ã¯è¨ˆç®—ä¸å¯èƒ½ï¼
  :::

## ğŸ”„ æ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼šãƒ¡ãƒ‡ã‚£ã‚¢ãƒ³æ–‡å­—åˆ—

### ç™ºæƒ³ã®è»¢æ›

å¾“æ¥ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼š

1. ãƒ¢ãƒãƒ¼ãƒ•ã‚’é¸ã¶ â†’ ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹ã‚’æ±‚ã‚ã‚‹

æ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼š

1. **ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹å€™è£œã‚’é¸ã¶** â†’ æœ€é©ãªãƒ¢ãƒãƒ¼ãƒ•ã‚’æ±‚ã‚ã‚‹

### Distance(Pattern, Motifs)

ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ãƒ¢ãƒãƒ¼ãƒ•é›†åˆé–“ã®è·é›¢ï¼š

```python
def distance_to_pattern(pattern, dna):
    """
    ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨DNAé…åˆ—é–“ã®æœ€å°ãƒãƒŸãƒ³ã‚°è·é›¢
    """
    k = len(pattern)
    min_distance = float('inf')

    for i in range(len(dna) - k + 1):
        kmer = dna[i:i+k]
        distance = hamming_distance(pattern, kmer)
        min_distance = min(min_distance, distance)

    return min_distance

def total_distance(pattern, dna_list):
    """
    ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã™ã¹ã¦ã®DNAé…åˆ—é–“ã®è·é›¢ã®ç·å’Œ
    """
    return sum(distance_to_pattern(pattern, dna)
               for dna in dna_list)
```

## ğŸ“Š ç­‰ä¾¡å•é¡Œã®å®šå¼åŒ–

ãƒ¢ãƒãƒ¼ãƒ•ç™ºè¦‹å•é¡Œã¯ä»¥ä¸‹ã¨ç­‰ä¾¡ï¼š

**ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ³æ–‡å­—åˆ—å•é¡Œ**ï¼š

- ã™ã¹ã¦ã®é…åˆ—ã¸ã®ç·è·é›¢ã‚’æœ€å°åŒ–ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
- è€ƒãˆã‚‰ã‚Œã‚‹4^kå€‹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰é¸æŠ

:::infoãƒ¡ãƒªãƒƒãƒˆ

- 4^kå€‹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¢ç´¢ï¼ˆ(n-k+1)^tå€‹ã®ãƒ¢ãƒãƒ¼ãƒ•çµ„ã¿åˆã‚ã›ã‚ˆã‚Šå¤§å¹…ã«å°‘ãªã„ï¼‰
- k = 15ãªã‚‰ç´„10å„„é€šã‚Šï¼ˆè¨ˆç®—å¯èƒ½ãªç¯„å›²ï¼‰ã€‚
  :::

## ğŸ“ ã¾ã¨ã‚

ã“ã®è¬›ç¾©ã§ã¯ã€ã‚ˆã‚Šå®Ÿç”¨çš„ãªãƒ¢ãƒãƒ¼ãƒ•ç™ºè¦‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å­¦ã³ã¾ã—ãŸï¼š

1. **ãƒ¢ãƒãƒ¼ãƒ•è¡Œåˆ—**ã«ã‚ˆã‚‹è¡¨ç¾
2. **ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹æ–‡å­—åˆ—**ã®æ§‹ç¯‰
3. **ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°é–¢æ•°**ã«ã‚ˆã‚‹è©•ä¾¡
4. **ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**ã®é™ç•Œ
5. **ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ³æ–‡å­—åˆ—**ã¸ã®å•é¡Œã®å¤‰æ›

## ğŸš€ æ¬¡å›äºˆå‘Š

æ¬¡å›ã¯ã€ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ³æ–‡å­—åˆ—å•é¡Œã®åŠ¹ç‡çš„ãªè§£æ³•ã‚’å­¦ã³ã¾ã™ï¼š

- ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ³æ–‡å­—åˆ—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- ã‚°ãƒªãƒ¼ãƒ‡ã‚£ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
- ç¢ºç‡çš„æ‰‹æ³•ã®å°å…¥

## ğŸ“š å‚è€ƒæ–‡çŒ®

- Coursera: Bioinformatics Specialization - Week 2
- Jones, N.C. and Pevzner, P.A. (2004) An Introduction to Bioinformatics Algorithms
