---
sidebar_position: 9
title: è¤‡æ•°é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆï¼šåŒæ™‚ã«å¤šæ•°ã®é…åˆ—ã‚’æ¯”è¼ƒã™ã‚‹
---

# è¤‡æ•°é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆï¼šåŒæ™‚ã«å¤šæ•°ã®é…åˆ—ã‚’æ¯”è¼ƒã™ã‚‹

## ğŸ¯ ã¾ãšã€ã“ã®è¬›ç¾©ã§ä½•ã‚’å­¦ã¶ã®ã‹

æœ€çµ‚ã‚´ãƒ¼ãƒ«ï¼š2ã¤ã§ã¯ãªãã€æ•°åã€œæ•°ç™¾ã®é…åˆ—ã‚’åŒæ™‚ã«æ¯”è¼ƒã—ã€é€²åŒ–çš„ã«ä¿å­˜ã•ã‚ŒãŸé ˜åŸŸã‚’è¦‹ã¤ã‘ã‚‹æ–¹æ³•ã‚’ç¿’å¾—ã—ã¾ã™ã€‚ã§ã‚‚ã€è¨ˆç®—é‡ã®çˆ†ç™ºã¨ã„ã†å£ã«ã¶ã¤ã‹ã‚Šã€å®Ÿç”¨çš„ãªè§£æ±ºç­–ã‚’æ¢ã‚Šã¾ã™ã€‚

ã§ã‚‚ã€ã¡ã‚‡ã£ã¨å¾…ã£ã¦ãã ã•ã„ã€‚ãã‚‚ãã‚‚..ã€‚

## ğŸ¤” ã‚¹ãƒ†ãƒƒãƒ—0ï¼šãªãœãƒšã‚¢ãƒ¯ã‚¤ã‚ºã§ã¯ä¸ååˆ†ãªã®ï¼Ÿ

### éš ã‚ŒãŸä¿å­˜é ˜åŸŸã®å•é¡Œ

```
2ã¤ã ã‘æ¯”è¼ƒï¼š
é…åˆ—A: ATCGATCG
é…åˆ—B: ATCGATAG
é¡ä¼¼åº¦ï¼š87.5%ï¼ˆã¾ã‚ã¾ã‚ï¼‰

ã§ã‚‚ã€10å€‹åŒæ™‚ã«æ¯”è¼ƒã™ã‚‹ã¨...
é…åˆ—A: ATCGATCG
é…åˆ—B: ATCGATAG
é…åˆ—C: ATCGATCG
é…åˆ—D: ATCGATCG
...
ä½ç½®5ã®Gï¼š10å€‹ä¸­9å€‹ã§ä¿å­˜ï¼
â†’ çµ±è¨ˆçš„ã«æ¥µã‚ã¦æœ‰æ„ï¼
```

### é€²åŒ–çš„ã‚·ã‚°ãƒŠãƒ«ã®å¢—å¹…

```python
# ãƒšã‚¢ãƒ¯ã‚¤ã‚ºã®é™ç•Œ
def pairwise_significance(seq1, seq2):
    """2é…åˆ—ã ã‘ã§ã¯å¶ç„¶ã®ä¸€è‡´ã¨åŒºåˆ¥ã—ã«ãã„"""
    similarity = calculate_similarity(seq1, seq2)
    # å¶ç„¶ã§ã‚‚70%ãã‚‰ã„ã¯ä¸€è‡´ã™ã‚‹ã“ã¨ãŒã‚ã‚‹
    return similarity > 0.7  # å¼±ã„è¨¼æ‹ 

# è¤‡æ•°é…åˆ—ã®å¨åŠ›
def multiple_significance(sequences):
    """å¤šæ•°ã§ä¿å­˜ã•ã‚Œã¦ã„ã‚Œã°å¶ç„¶ã§ã¯ãªã„ï¼"""
    conserved_positions = find_conserved_columns(sequences)
    # 10é…åˆ—ã§90%ä¿å­˜ãªã‚‰å¶ç„¶ã®ç¢ºç‡ã¯0.9^10 = 0.00000001%
    return len(conserved_positions)  # å¼·åŠ›ãªè¨¼æ‹ ï¼
```

### å®Ÿä¾‹ï¼šã‚¢ãƒ‡ãƒ‹ãƒ«åŒ–ãƒ‰ãƒ¡ã‚¤ãƒ³

```
3ã¤ã®A-domainé…åˆ—ï¼š
ãƒšã‚¢ãƒ¯ã‚¤ã‚ºæ¯”è¼ƒã§ã¯è¦‹ãˆãªã„
â†“
3ã¤åŒæ™‚ã«æ¯”è¼ƒ
â†“
å…±é€šã®ãƒ¢ãƒãƒ¼ãƒ•ç™ºè¦‹ï¼
â†’ åŒã˜æ©Ÿèƒ½ã‚’æŒã¤è¨¼æ‹ 
```

## ğŸ“Š ã‚¹ãƒ†ãƒƒãƒ—1ï¼š3æ¬¡å…ƒã¸ã®æ‹¡å¼µ

### 1-1. 2æ¬¡å…ƒã‹ã‚‰3æ¬¡å…ƒã¸

```
2é…åˆ—ï¼ˆ2Dï¼‰ï¼š
â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹
â”‚ â•² â”‚ â•² â”‚
â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹
â”‚ â•² â”‚ â•² â”‚
â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹

3é…åˆ—ï¼ˆ3Dï¼‰ï¼š
    â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹
   /â”‚â•² /â”‚â•² /â”‚
  â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹ â”‚
 /â”‚â•² /â”‚â•² /â”‚ â”‚
â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚ â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹ â”‚
â”‚/  â”‚/  â”‚/  â”‚/
â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹
```

### 1-2. åº§æ¨™ã§ã®è¡¨ç¾

```python
# 3é…åˆ—ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆä¾‹
seq1 = "ATGC"
seq2 = "AATC"
seq3 = "ATGC"

# ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆçµæœ
# A-TGC
# AATC
# A-TGC

# 3æ¬¡å…ƒåº§æ¨™ã¨ã—ã¦è¡¨ç¾
path = [
    (0,0,0),  # é–‹å§‹
    (1,1,1),  # A,A,Aï¼ˆ3ã¤ã¨ã‚‚é€²ã‚€ï¼‰
    (1,2,1),  # -,A,-ï¼ˆseq2ã ã‘é€²ã‚€ï¼‰
    (2,3,2),  # T,T,Tï¼ˆ3ã¤ã¨ã‚‚é€²ã‚€ï¼‰
    (3,3,3),  # G,-,Gï¼ˆseq2ã¯ã‚®ãƒ£ãƒƒãƒ—ï¼‰
    (4,4,4)   # C,C,Cï¼ˆ3ã¤ã¨ã‚‚é€²ã‚€ï¼‰
]
```

### 1-3. ã‚¨ãƒƒã‚¸ã®å¢—åŠ 

```
2æ¬¡å…ƒã§ã®é¸æŠè‚¢ï¼š3æ–¹å‘
- æ°´å¹³ï¼ˆå‰Šé™¤ï¼‰
- å‚ç›´ï¼ˆæŒ¿å…¥ï¼‰
- å¯¾è§’ï¼ˆãƒãƒƒãƒ/ãƒŸã‚¹ãƒãƒƒãƒï¼‰

3æ¬¡å…ƒã§ã®é¸æŠè‚¢ï¼š7æ–¹å‘ï¼
- (1,0,0), (0,1,0), (0,0,1)  # 1ã¤ã ã‘é€²ã‚€
- (1,1,0), (1,0,1), (0,1,1)  # 2ã¤é€²ã‚€
- (1,1,1)                     # 3ã¤ã¨ã‚‚é€²ã‚€
```

## ğŸ˜± ã‚¹ãƒ†ãƒƒãƒ—2ï¼šè¨ˆç®—é‡ã®çˆ†ç™º

### 2-1. æã‚ã—ã„ç¾å®Ÿ

```python
def complexity_analysis(k, n):
    """kå€‹ã®é•·ã•nã®é…åˆ—ã‚’ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ"""

    # ã‚°ãƒªãƒƒãƒ‰ã®ã‚µã‚¤ã‚º
    grid_size = n ** k

    # å„ãƒãƒ¼ãƒ‰ã®éš£æ¥æ•°
    neighbors = 2 ** k - 1

    # ç·è¨ˆç®—é‡
    total = grid_size * neighbors

    return total

# ä¾‹
print(complexity_analysis(2, 100))  # 10,000 Ã— 3 = 30,000ï¼ˆå®Ÿç”¨çš„ï¼‰
print(complexity_analysis(3, 100))  # 1,000,000 Ã— 7 = 7,000,000ï¼ˆã¾ã OKï¼‰
print(complexity_analysis(10, 100)) # 10^20 Ã— 1023 = 10^23ï¼ˆä¸å¯èƒ½ï¼ï¼‰
```

### 2-2. å®‡å®™çš„ãªæ™‚é–“

```
18å€‹ã®é•·ã•18ã®é…åˆ—ï¼š
è¨ˆç®—æ™‚é–“ = 18^18 Ã— (2^18 - 1) ã‚¹ãƒ†ãƒƒãƒ—
        â‰ˆ 10^30 ã‚¹ãƒ†ãƒƒãƒ—

æœ€é€Ÿã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ï¼ˆ10^15 ã‚¹ãƒ†ãƒƒãƒ—/ç§’ï¼‰ã§ã‚‚ï¼š
10^30 Ã· 10^15 = 10^15ç§’
              = 317å„„å¹´
              > å®‡å®™ã®å¹´é½¢ï¼ˆ138å„„å¹´ï¼‰

çµ¶æœ›çš„...
```

### 2-3. ãªãœã“ã‚“ãªã«å¢—ãˆã‚‹ã®ï¼Ÿ

```
æ¬¡å…ƒã®å‘ªã„ï¼š
kæ¬¡å…ƒ = é¸æŠè‚¢ãŒ2^kå€
      = ç©ºé–“ãŒn^kå€

ä¾‹ï¼š10é…åˆ—
å„ã‚¹ãƒ†ãƒƒãƒ—ã§1024é€šã‚Šã®é¸æŠ
â†’ å®Œå…¨æ¢ç´¢ã¯ç¾å®Ÿçš„ã«ä¸å¯èƒ½
```

## ğŸ’¡ ã‚¹ãƒ†ãƒƒãƒ—3ï¼šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã„ã†ç™ºæƒ³

### 3-1. ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯

```
è¤‡æ•°é…åˆ—ã®çµ±è¨ˆçš„è¡¨ç¾ï¼š

é…åˆ—1: ATCG
é…åˆ—2: ACCG
é…åˆ—3: ATAG
é…åˆ—4: ATCG
é…åˆ—5: -TCG

ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆå„ä½ç½®ã§ã®é »åº¦ï¼‰ï¼š
ä½ç½®:   1    2    3    4
A:     4/5  0/5  1/5  0/5
T:     0/5  4/5  0/5  0/5
C:     0/5  1/5  2/5  0/5
G:     0/5  0/5  0/5  5/5
-:     1/5  0/5  2/5  0/5
```

### 3-2. ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ©ç‚¹

```python
class Profile:
    """è¤‡æ•°é…åˆ—ã‚’1ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦æ‰±ã†"""

    def __init__(self, sequences):
        self.frequencies = self.calculate_frequencies(sequences)

    def score_with_sequence(self, seq, position):
        """é…åˆ—ã¨ã®ä¸€è‡´ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—"""
        score = 0
        for i, char in enumerate(seq):
            score += self.frequencies[position + i][char]
        return score

    def merge_with_profile(self, other_profile):
        """2ã¤ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµåˆ"""
        # é‡ã¿ä»˜ãå¹³å‡ã§æ–°ã—ã„ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
        return merged_profile
```

### 3-3. ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åŒå£«ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ

```
ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«1:     ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«2:
A: 0.8            A: 0.6
T: 0.2            T: 0.3
C: 0.0            C: 0.1
G: 0.0            G: 0.0

ã‚¹ã‚³ã‚¢ = 0.8Ã—0.6 + 0.2Ã—0.3 = 0.54
ï¼ˆç¢ºç‡çš„ãªä¸€è‡´åº¦ï¼‰
```

## ğŸ¯ ã‚¹ãƒ†ãƒƒãƒ—4ï¼šè²ªæ¬²ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### 4-1. åŸºæœ¬æˆ¦ç•¥

```
1. ã™ã¹ã¦ã®ãƒšã‚¢ãƒ¯ã‚¤ã‚ºã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã‚’è¨ˆç®—
2. æœ€ã‚‚é¡ä¼¼ã—ãŸ2ã¤ã‚’çµåˆ
3. çµåˆã—ãŸã‚‚ã®ã‚’ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ‰±ã†
4. 1ã¤ã«ãªã‚‹ã¾ã§ç¹°ã‚Šè¿”ã™

å¤©æ‰çš„ãªå˜ç´”åŒ–ï¼
```

### 4-2. å…·ä½“ä¾‹ã§ã®å®Ÿè¡Œ

```python
def greedy_multiple_alignment(sequences):
    """è²ªæ¬²æ³•ã«ã‚ˆã‚‹è¤‡æ•°é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ"""

    # ã‚¹ãƒ†ãƒƒãƒ—1ï¼šå…¨ãƒšã‚¢ãƒ¯ã‚¤ã‚ºã‚¹ã‚³ã‚¢è¨ˆç®—
    scores = {}
    for i in range(len(sequences)):
        for j in range(i+1, len(sequences)):
            scores[(i,j)] = pairwise_score(sequences[i], sequences[j])

    # ä¾‹ï¼š4é…åˆ—ã®å ´åˆ
    # GATTCA, GTCTGA, GATATT, GTCAGC
    #
    # ãƒšã‚¢ãƒ¯ã‚¤ã‚ºã‚¹ã‚³ã‚¢ï¼š
    # (0,1): -1
    # (0,2): 1
    # (0,3): 0
    # (1,2): -2
    # (1,3): 2  â† æœ€é«˜ã‚¹ã‚³ã‚¢ï¼
    # (2,3): -1

    # ã‚¹ãƒ†ãƒƒãƒ—2ï¼šæœ€ã‚‚è¿‘ã„2ã¤ã‚’çµåˆ
    best_pair = (1, 3)  # GTCTGA ã¨ GTCAGC
    profile_1_3 = create_profile([sequences[1], sequences[3]])

    # æ–°ã—ã„é…åˆ—ã‚»ãƒƒãƒˆï¼š
    # [GATTCA, GATATT, Profile(GTCTGA,GTCAGC)]

    # ã‚¹ãƒ†ãƒƒãƒ—3ï¼šç¹°ã‚Šè¿”ã—
    # ... æœ€çµ‚çš„ã«1ã¤ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«
```

### 4-3. å®Ÿè¡Œä¾‹ã®å¯è¦–åŒ–

```
åˆæœŸçŠ¶æ…‹ï¼š
seq1: GATTCA
seq2: GTCTGA
seq3: GATATT
seq4: GTCAGC

ã‚¹ãƒ†ãƒƒãƒ—1ï¼šseq2ã¨seq4ã‚’çµåˆ
seq1: GATTCA
seq3: GATATT
prof2_4: GTC-TGA
         GTCAGC-

ã‚¹ãƒ†ãƒƒãƒ—2ï¼šseq1ã¨seq3ã‚’çµåˆ
prof1_3: GATTCA
         GATATT
prof2_4: (å‰ã®ã¾ã¾)

ã‚¹ãƒ†ãƒƒãƒ—3ï¼š2ã¤ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµåˆ
æœ€çµ‚ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆï¼š
GA-TTCA
GA-TATT
GTC-TGA
GTCAGC-
```

## ğŸš€ ã‚¹ãƒ†ãƒƒãƒ—5ï¼šæ”¹è‰¯ã¨æœ€é©åŒ–

### 5-1. ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ

```python
def progressive_alignment(sequences):
    """ç³»çµ±æ¨¹ã‚¬ã‚¤ãƒ‰ã«ã‚ˆã‚‹æ”¹è‰¯ç‰ˆ"""

    # 1. ç³»çµ±æ¨¹ã‚’æ§‹ç¯‰
    tree = build_guide_tree(sequences)

    # 2. è‘‰ã‹ã‚‰æ ¹ã¸å‘ã‹ã£ã¦ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
    def align_node(node):
        if node.is_leaf():
            return node.sequence
        else:
            left_align = align_node(node.left)
            right_align = align_node(node.right)
            return profile_align(left_align, right_align)

    return align_node(tree.root)
```

### 5-2. åå¾©æ”¹è‰¯

```
åˆæœŸã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
â†“
é…åˆ—ã‚’1ã¤é™¤å¤–
â†“
æ®‹ã‚Šã‚’å†ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
â†“
é™¤å¤–ã—ãŸé…åˆ—ã‚’å†æŒ¿å…¥
â†“
ã‚¹ã‚³ã‚¢æ”¹å–„ãŒã‚ã‚Œã°æ¡ç”¨
â†“
ã™ã¹ã¦ã®é…åˆ—ã§ç¹°ã‚Šè¿”ã—
```

### 5-3. å®Ÿç”¨ãƒ„ãƒ¼ãƒ«

```python
# å®Ÿéš›ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ãƒ„ãƒ¼ãƒ«
tools = {
    'Clustal': 'ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–æ³•ã®å®šç•ª',
    'MUSCLE': 'é«˜é€Ÿãƒ»é«˜ç²¾åº¦',
    'MAFFT': 'å¤§è¦æ¨¡é…åˆ—ã«å¼·ã„',
    'T-Coffee': 'è¤‡æ•°ã®æƒ…å ±æºã‚’çµ±åˆ'
}

# ä½¿ç”¨ä¾‹ï¼ˆMUSCLEï¼‰
def run_muscle(sequences):
    """MUSCLEã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç°¡ç•¥ç‰ˆ"""
    # 1. é«˜é€Ÿãªè·é›¢è¨ˆç®—
    distances = fast_distance_matrix(sequences)

    # 2. UPGMAæ³•ã§ç³»çµ±æ¨¹æ§‹ç¯‰
    tree = upgma(distances)

    # 3. ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
    alignment = progressive_align(tree, sequences)

    # 4. åå¾©æ”¹è‰¯
    for iteration in range(max_iterations):
        alignment = refine(alignment)
        if not improved:
            break

    return alignment
```

## ğŸ’¡ ã‚¹ãƒ†ãƒƒãƒ—6ï¼šã¾ã¨ã‚

### ãƒ¬ãƒ™ãƒ«1ï¼šåŸºç¤ç†è§£

```
å­¦ã‚“ã ã“ã¨ï¼š
1. è¤‡æ•°é…åˆ—ã®é‡è¦æ€§ï¼ˆçµ±è¨ˆçš„æœ‰æ„æ€§ï¼‰
2. æ¬¡å…ƒã®å‘ªã„ï¼ˆæŒ‡æ•°é–¢æ•°çš„å¢—åŠ ï¼‰
3. ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯ã®å¿…è¦æ€§
```

### ãƒ¬ãƒ™ãƒ«2ï¼šå¿œç”¨ç†è§£

```
ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã“ã¨ï¼š
1. ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
2. è²ªæ¬²æ³•ã«ã‚ˆã‚‹è¿‘ä¼¼è§£
3. å®Ÿç”¨çš„ãªå¤šé‡é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
```

### ãƒ¬ãƒ™ãƒ«3ï¼šå®Ÿè£…ç†è§£

```python
# å®Œå…¨ãªè²ªæ¬²ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè£…
class MultipleAligner:
    def __init__(self):
        self.sequences = []
        self.profiles = []

    def align(self, sequences):
        """è²ªæ¬²æ³•ã«ã‚ˆã‚‹å¤šé‡é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ"""
        n = len(sequences)

        # åˆæœŸåŒ–ï¼šå„é…åˆ—ã‚’å˜ç‹¬ã®ã‚¯ãƒ©ã‚¹ã‚¿ã¨ã™ã‚‹
        clusters = [[i] for i in range(n)]
        alignments = [[seq] for seq in sequences]

        while len(clusters) > 1:
            # æœ€ã‚‚è¿‘ã„ãƒšã‚¢ã‚’è¦‹ã¤ã‘ã‚‹
            best_score = float('-inf')
            best_i, best_j = 0, 1

            for i in range(len(clusters)):
                for j in range(i+1, len(clusters)):
                    score = self.profile_score(
                        alignments[i],
                        alignments[j]
                    )
                    if score > best_score:
                        best_score = score
                        best_i, best_j = i, j

            # ã‚¯ãƒ©ã‚¹ã‚¿ã‚’çµåˆ
            merged = self.merge_alignments(
                alignments[best_i],
                alignments[best_j]
            )

            # ãƒªã‚¹ãƒˆã‚’æ›´æ–°
            new_cluster = clusters[best_i] + clusters[best_j]
            clusters = [c for k, c in enumerate(clusters)
                       if k != best_i and k != best_j]
            clusters.append(new_cluster)

            alignments = [a for k, a in enumerate(alignments)
                         if k != best_i and k != best_j]
            alignments.append(merged)

        return alignments[0]

    def profile_score(self, align1, align2):
        """2ã¤ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã®ã‚¹ã‚³ã‚¢"""
        profile1 = self.make_profile(align1)
        profile2 = self.make_profile(align2)

        # ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åŒå£«ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã‚¹ã‚³ã‚¢
        return self.align_profiles(profile1, profile2)

    def make_profile(self, alignment):
        """ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã‹ã‚‰ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ"""
        length = len(alignment[0])
        profile = []

        for pos in range(length):
            column = [seq[pos] for seq in alignment]
            frequencies = {}
            for char in 'ATCG-':
                frequencies[char] = column.count(char) / len(column)
            profile.append(frequencies)

        return profile
```

## ğŸš€ æ¬¡å›äºˆå‘Š

æ¬¡å›ã¯ã€Œã‚²ãƒãƒ å†é…åˆ—ã€ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚é€²åŒ–ã®éç¨‹ã§èµ·ã“ã‚‹å¤§è¦æ¨¡ãªæŸ“è‰²ä½“ã®å†ç·¨æˆã‚’ã©ã†ã‚„ã£ã¦æ¤œå‡ºã—ã€å¾©å…ƒã™ã‚‹ã®ã‹ï¼Ÿã€€ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚°ãƒ©ãƒ•ã®ä¸–ç•Œã¸é£›ã³è¾¼ã¿ã¾ã™ï¼

---

_2ã¤ã‹ã‚‰å¤šæ•°ã¸ã€é…åˆ—æ¯”è¼ƒã®æ–°ãŸãªæ¬¡å…ƒã¸ï¼_
