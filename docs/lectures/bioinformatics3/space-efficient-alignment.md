---
sidebar_position: 8
title: ç©ºé–“åŠ¹ç‡ã®è‰¯ã„é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆï¼šHirschbergã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
---

# ç©ºé–“åŠ¹ç‡ã®è‰¯ã„é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆï¼šHirschbergã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

## ğŸ¯ ã¾ãšã€ã“ã®è¬›ç¾©ã§ä½•ã‚’å­¦ã¶ã®ã‹

æœ€çµ‚ã‚´ãƒ¼ãƒ«ï¼šæ•°ä¸‡å¡©åŸºã®é•·ã„é…åˆ—ã§ã‚‚ã€ãƒ¡ãƒ¢ãƒªä¸è¶³ã«ãªã‚‰ãšã«ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã‚’è¨ˆç®—ã§ãã‚‹é­”æ³•ã®ã‚ˆã†ãªåˆ†å‰²çµ±æ²»æ³•ã‚’ç¿’å¾—ã—ã¾ã™ã€‚

ã§ã‚‚ã€ã¡ã‚‡ã£ã¨å¾…ã£ã¦ãã ã•ã„ã€‚ãã‚‚ãã‚‚..ã€‚

## ğŸ¤” ã‚¹ãƒ†ãƒƒãƒ—0ï¼šãªãœãƒ¡ãƒ¢ãƒªãŒå•é¡Œã«ãªã‚‹ã®ï¼Ÿ

### ç¾å®Ÿã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯

```
10,000å¡©åŸºã®é…åˆ—æ¯”è¼ƒï¼š
å¿…è¦ãƒ¡ãƒ¢ãƒª = 10,000 Ã— 10,000 Ã— 4ãƒã‚¤ãƒˆ
         = 400MB

100,000å¡©åŸºã®é…åˆ—æ¯”è¼ƒï¼š
å¿…è¦ãƒ¡ãƒ¢ãƒª = 100,000 Ã— 100,000 Ã— 4ãƒã‚¤ãƒˆ
         = 40GBï¼

â†’ æ™®é€šã®PCã§ã¯ç„¡ç†ï¼
```

### CPUã¨ãƒ¡ãƒ¢ãƒªã®é•ã„

```python
# CPUã¯é€Ÿã„
def cpu_intensive():
    """1ç§’é–“ã«æ•°åå„„å›ã®è¨ˆç®—ãŒå¯èƒ½"""
    for i in range(1_000_000_000):
        result = i * 2  # è¶…é«˜é€Ÿ

# ãƒ¡ãƒ¢ãƒªã¯é™ç•ŒãŒã‚ã‚‹
def memory_intensive():
    """æ•°GBã®ãƒ¡ãƒ¢ãƒªã¯ã™ãã«æ¯æ¸‡"""
    huge_matrix = [[0] * 100000 for _ in range(100000)]
    # MemoryError!
```

### é‡è¦ãªè¦³å¯Ÿ

```
å®Ÿè¡Œæ™‚é–“ï¼šå¾…ã¦ã°ã„ã„ï¼ˆæ•°ç§’ã€œæ•°åˆ†ï¼‰
ãƒ¡ãƒ¢ãƒªä¸è¶³ï¼šã©ã†ã—ã‚ˆã†ã‚‚ãªã„ï¼

â†’ ãƒ¡ãƒ¢ãƒªã“ããŒçœŸã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯
```

## ğŸ“ ã‚¹ãƒ†ãƒƒãƒ—1ï¼šä¸­é–“ãƒãƒ¼ãƒ‰ã¨ã„ã†ç™ºæƒ³

### 1-1. ä¸­å¤®ã®åˆ—ã®å®šç¾©

```
ãƒãƒ³ãƒãƒƒã‚¿ãƒ³ã‚°ãƒªãƒƒãƒ‰ï¼š
â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹
â”‚ â•² â”‚ â•² â”‚ â•² â”‚ â•² â”‚
â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹
â”‚ â•² â”‚ â•² â”‚ â•² â”‚ â•² â”‚
â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹
        â†‘
    ä¸­å¤®ã®åˆ—
```

### 1-2. ä¸­é–“ãƒãƒ¼ãƒ‰ã¨ã¯

```python
# ä¸­é–“ãƒãƒ¼ãƒ‰ = æœ€é©çµŒè·¯ãŒä¸­å¤®ã®åˆ—ã‚’é€šã‚‹ç‚¹

def find_middle_node(grid):
    """æœ€é©çµŒè·¯ãŒå¿…ãšé€šã‚‹ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹"""
    middle_column = len(grid[0]) // 2

    # ã“ã®åˆ—ã®ã©ã“ã‹ã‚’æœ€é©çµŒè·¯ãŒé€šã‚‹
    # ã§ã‚‚ã€ã©ã®ãƒãƒ¼ãƒ‰ï¼Ÿ
```

### 1-3. åˆ†å‰²çµ±æ²»ã®è€ƒãˆæ–¹

```
ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š
1. ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹
2. å•é¡Œã‚’2ã¤ã«åˆ†å‰²ï¼š
   - ã‚½ãƒ¼ã‚¹ â†’ ä¸­é–“ãƒãƒ¼ãƒ‰
   - ä¸­é–“ãƒãƒ¼ãƒ‰ â†’ ã‚·ãƒ³ã‚¯
3. å†å¸°çš„ã«è§£ã

å¤©æ‰çš„ï¼ã§ã‚‚ã€ã©ã†ã‚„ã£ã¦ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ï¼Ÿ
```

## ğŸ’¡ ã‚¹ãƒ†ãƒƒãƒ—2ï¼šç·šå½¢ç©ºé–“ã§ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—

### 2-1. å¾“æ¥ã®æ–¹æ³•ã®å•é¡Œ

```python
# å¾“æ¥ï¼šå…¨ãƒãƒ¼ãƒ‰ã®ã‚¹ã‚³ã‚¢ã‚’ä¿å­˜
def naive_alignment(v, w):
    m, n = len(v), len(w)
    # O(mn)ã®ãƒ¡ãƒ¢ãƒªãŒå¿…è¦ï¼
    scores = [[0] * (n+1) for _ in range(m+1)]

    for i in range(1, m+1):
        for j in range(1, n+1):
            scores[i][j] = max(...)

    return scores[m][n]
```

### 2-2. ç”»æœŸçš„ãªè¦³å¯Ÿ

```
é‡è¦ãªç™ºè¦‹ï¼š
åˆ—jã®ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã™ã‚‹ã«ã¯ã€
åˆ—j-1ã®ã‚¹ã‚³ã‚¢ã ã‘ã‚ã‚Œã°ã„ã„ï¼

éå»ã®åˆ—ã¯å¿˜ã‚Œã¦ã„ã„ï¼
```

### 2-3. ç·šå½¢ç©ºé–“ã®å®Ÿè£…

```python
def linear_space_score(v, w):
    """O(min(m,n))ã®ãƒ¡ãƒ¢ãƒªã§ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—"""
    m, n = len(v), len(w)

    # 2åˆ—åˆ†ã®ãƒ¡ãƒ¢ãƒªã ã‘ï¼
    previous_column = [0] * (m+1)
    current_column = [0] * (m+1)

    # åˆæœŸåŒ–
    for i in range(m+1):
        previous_column[i] = -i * gap_penalty

    # åˆ—ã”ã¨ã«å‡¦ç†
    for j in range(1, n+1):
        current_column[0] = -j * gap_penalty

        for i in range(1, m+1):
            match = previous_column[i-1] + score(v[i-1], w[j-1])
            delete = previous_column[i] + gap_penalty
            insert = current_column[i-1] + gap_penalty

            current_column[i] = max(match, delete, insert)

        # åˆ—ã‚’å…¥ã‚Œæ›¿ãˆï¼ˆãƒ¡ãƒ¢ãƒªå†åˆ©ç”¨ï¼‰
        previous_column, current_column = current_column, previous_column

    return previous_column[m]  # ã‚¹ã‚³ã‚¢ã ã‘
```

## ğŸ” ã‚¹ãƒ†ãƒƒãƒ—3ï¼šä¸­é–“ãƒãƒ¼ãƒ‰ã®ç™ºè¦‹

### 3-1. i-ãƒ‘ã‚¹ã®å®šç¾©

```
i-pathï¼šä¸­å¤®ã®åˆ—ã®iç•ªç›®ã®ãƒãƒ¼ãƒ‰ã‚’é€šã‚‹æœ€é•·çµŒè·¯

ä¾‹ï¼šä¸­å¤®ã®åˆ—ã®å„ãƒãƒ¼ãƒ‰
ãƒãƒ¼ãƒ‰0: i-pathã®é•·ã• = 2
ãƒãƒ¼ãƒ‰1: i-pathã®é•·ã• = 3
ãƒãƒ¼ãƒ‰2: i-pathã®é•·ã• = 3
ãƒãƒ¼ãƒ‰3: i-pathã®é•·ã• = 4 â† æœ€å¤§ï¼ï¼ˆä¸­é–“ãƒãƒ¼ãƒ‰ï¼‰
ãƒãƒ¼ãƒ‰4: i-pathã®é•·ã• = 3
ãƒãƒ¼ãƒ‰5: i-pathã®é•·ã• = 1
```

### 3-2. é•·ã•ã®è¨ˆç®—æ–¹æ³•

```python
def find_middle_node(v, w):
    """ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹"""
    m, n = len(v), len(w)
    middle_col = n // 2

    # fromSource[i] = ã‚½ãƒ¼ã‚¹ã‹ã‚‰(i, middle_col)ã¾ã§ã®æœ€é•·çµŒè·¯
    fromSource = compute_forward(v[:], w[:middle_col])

    # toSink[i] = (i, middle_col)ã‹ã‚‰ã‚·ãƒ³ã‚¯ã¾ã§ã®æœ€é•·çµŒè·¯
    toSink = compute_backward(v[:], w[middle_col:])

    # i-pathã®é•·ã• = fromSource[i] + toSink[i]
    max_length = float('-inf')
    middle_row = 0

    for i in range(m+1):
        length = fromSource[i] + toSink[i]
        if length > max_length:
            max_length = length
            middle_row = i

    return middle_row, middle_col
```

### 3-3. é€†æ–¹å‘ã®è¨ˆç®—

```python
def compute_backward(v, w):
    """ã‚·ãƒ³ã‚¯ã‹ã‚‰é€†æ–¹å‘ã«è¨ˆç®—"""
    m, n = len(v), len(w)

    # é€†å‘ãã«å‹•çš„è¨ˆç”»æ³•
    previous_column = [0] * (m+1)
    current_column = [0] * (m+1)

    # å³ä¸‹ã‹ã‚‰é–‹å§‹
    for j in range(n-1, -1, -1):
        for i in range(m-1, -1, -1):
            # é€†æ–¹å‘ã®ã‚¨ãƒƒã‚¸ã‚’è¾¿ã‚‹
            match = previous_column[i+1] + score(v[i], w[j])
            delete = previous_column[i] + gap_penalty
            insert = current_column[i+1] + gap_penalty

            current_column[i] = max(match, delete, insert)

        previous_column, current_column = current_column, previous_column

    return previous_column
```

## ğŸ¯ ã‚¹ãƒ†ãƒƒãƒ—4ï¼šåˆ†å‰²çµ±æ²»æ³•

### 4-1. å†å¸°çš„åˆ†å‰²

```
åˆå›ï¼šé¢ç© = mn
  â†“ ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹
2åˆ†å‰²ï¼šå„é¢ç© = mn/2
  â†“ ãã‚Œãã‚Œã®ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹
4åˆ†å‰²ï¼šå„é¢ç© = mn/4
  â†“ ã•ã‚‰ã«åˆ†å‰²
8åˆ†å‰²ï¼šå„é¢ç© = mn/8
  ...
```

### 4-2. å®Ÿè¡Œæ™‚é–“ã®åˆ†æ

```python
# å„ãƒ¬ãƒ™ãƒ«ã§ã®è¨ˆç®—é‡
def time_complexity_analysis():
    """
    ãƒ¬ãƒ™ãƒ«0: mn     ï¼ˆå…¨ä½“ã‚’1å›èµ°æŸ»ï¼‰
    ãƒ¬ãƒ™ãƒ«1: mn/2Ã—2 = mn ï¼ˆåŠåˆ†ã‚’2å›èµ°æŸ»ï¼‰
    ãƒ¬ãƒ™ãƒ«2: mn/4Ã—4 = mn ï¼ˆ1/4ã‚’4å›èµ°æŸ»ï¼‰
    ãƒ¬ãƒ™ãƒ«3: mn/8Ã—8 = mn ï¼ˆ1/8ã‚’8å›èµ°æŸ»ï¼‰
    ...

    åˆè¨ˆ: mn Ã— log(mn) â‰ˆ 2mn
    """
    # ã¤ã¾ã‚Šã€ã»ã¼ç·šå½¢æ™‚é–“ï¼
```

### 4-3. ãªãœã“ã‚ŒãŒåŠ¹ç‡çš„ï¼Ÿ

```
é€šå¸¸ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼š
æ™‚é–“: O(mn)
ç©ºé–“: O(mn) â† å•é¡Œï¼

Hirschbergã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼š
æ™‚é–“: O(mn) Ã— 2 â† ã‚ãšã‹ã«é…ã„
ç©ºé–“: O(m+n) â† åŠ‡çš„ã«æ”¹å–„ï¼
```

## ğŸ’» ã‚¹ãƒ†ãƒƒãƒ—5ï¼šå®Œå…¨ãªå®Ÿè£…

### 5-1. ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

```python
class HirschbergAligner:
    def align(self, v, w):
        """ç·šå½¢ç©ºé–“ã§ã®é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ"""
        if len(v) == 0:
            return [('-', c) for c in w]
        if len(w) == 0:
            return [(c, '-') for c in v]
        if len(w) == 1:
            return self.align_with_single_char(v, w[0])

        # ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹
        mid_row, mid_col = self.find_middle_node(v, w)

        # å†å¸°çš„ã«å‰åŠã¨å¾ŒåŠã‚’è§£ã
        alignment1 = self.align(v[:mid_row], w[:mid_col])
        alignment2 = self.align(v[mid_row:], w[mid_col:])

        return alignment1 + alignment2
```

### 5-2. ä¸­é–“ãƒãƒ¼ãƒ‰æ¢ç´¢

```python
    def find_middle_node(self, v, w):
        """æœ€é©çµŒè·¯ãŒé€šã‚‹ä¸­é–“ãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹"""
        m, n = len(v), len(w)
        mid_col = n // 2

        # å‰åŠã®ã‚¹ã‚³ã‚¢ï¼ˆã‚½ãƒ¼ã‚¹ã‹ã‚‰ä¸­å¤®åˆ—ã¾ã§ï¼‰
        forward_scores = self.forward_scores(v, w[:mid_col])

        # å¾ŒåŠã®ã‚¹ã‚³ã‚¢ï¼ˆä¸­å¤®åˆ—ã‹ã‚‰ã‚·ãƒ³ã‚¯ã¾ã§ï¼‰
        backward_scores = self.backward_scores(v, w[mid_col:])

        # æœ€é©ãªè¡Œã‚’è¦‹ã¤ã‘ã‚‹
        max_score = float('-inf')
        best_row = 0

        for i in range(m + 1):
            score = forward_scores[i] + backward_scores[m - i]
            if score > max_score:
                max_score = score
                best_row = i

        return best_row, mid_col
```

### 5-3. ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã®å®Ÿè¨¼

```python
def memory_comparison():
    """ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æ¯”è¼ƒ"""

    # é…åˆ—é•·
    lengths = [100, 1000, 10000, 100000]

    for n in lengths:
        # é€šå¸¸ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
        naive_memory = n * n * 4  # ãƒã‚¤ãƒˆ

        # Hirschbergã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
        hirschberg_memory = 2 * n * 4  # ãƒã‚¤ãƒˆ

        ratio = naive_memory / hirschberg_memory

        print(f"é…åˆ—é•· {n}:")
        print(f"  é€šå¸¸: {naive_memory / 1e6:.1f} MB")
        print(f"  Hirschberg: {hirschberg_memory / 1e6:.4f} MB")
        print(f"  å‰Šæ¸›ç‡: {ratio:.0f}å€")

# å‡ºåŠ›ï¼š
# é…åˆ—é•· 100:
#   é€šå¸¸: 0.0 MB
#   Hirschberg: 0.0008 MB
#   å‰Šæ¸›ç‡: 50å€
#
# é…åˆ—é•· 10000:
#   é€šå¸¸: 400.0 MB
#   Hirschberg: 0.08 MB
#   å‰Šæ¸›ç‡: 5000å€ï¼
```

## ğŸ§¬ ã‚¹ãƒ†ãƒƒãƒ—6ï¼šå®Ÿç”¨çš„å¿œç”¨

### 6-1. ã‚²ãƒãƒ æ¯”è¼ƒ

```python
def compare_genomes(genome1, genome2):
    """å·¨å¤§ãªã‚²ãƒãƒ ã‚’æ¯”è¼ƒ"""
    # å¾“æ¥ï¼šãƒ¡ãƒ¢ãƒªä¸è¶³ã§ã‚¯ãƒ©ãƒƒã‚·ãƒ¥
    # Hirschbergï¼šå•é¡Œãªãå®Ÿè¡Œå¯èƒ½

    aligner = HirschbergAligner()
    alignment = aligner.align(genome1, genome2)

    return calculate_similarity(alignment)
```

### 6-2. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ

```
ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ï¼š
- ã‚·ãƒ¼ã‚±ãƒ³ã‚µãƒ¼ã‹ã‚‰ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿
- ãƒ¡ãƒ¢ãƒªã«å…¨ä½“ã‚’ä¿æŒã§ããªã„
- Hirschbergãªã‚‰å‡¦ç†å¯èƒ½ï¼
```

### 6-3. çµ„ã¿è¾¼ã¿ã‚·ã‚¹ãƒ†ãƒ 

```python
# ãƒ¡ãƒ¢ãƒªåˆ¶é™ã®ã‚ã‚‹ç’°å¢ƒ
class EmbeddedAligner:
    """IoTãƒ‡ãƒã‚¤ã‚¹ã‚„ãƒ¢ãƒã‚¤ãƒ«ã§ã‚‚å‹•ä½œ"""

    MAX_MEMORY = 1 * 1024 * 1024  # 1MB

    def can_align(self, seq1, seq2):
        required_memory = 2 * max(len(seq1), len(seq2)) * 4
        return required_memory <= self.MAX_MEMORY
```

## ğŸ¨ ã‚¹ãƒ†ãƒƒãƒ—7ï¼šè¦–è¦šçš„ç†è§£

### 7-1. åˆ†å‰²ã®æ§˜å­

```
ã‚¹ãƒ†ãƒƒãƒ—1ï¼šå…¨ä½“ã‚’è¦‹ã‚‹
â– â– â– â– â– â– â– â– 
â– â– â– â– â– â– â– â– 
â– â– â– â– â– â– â– â– 
â– â– â– â– â– â– â– â– 

ã‚¹ãƒ†ãƒƒãƒ—2ï¼šä¸­é–“ãƒãƒ¼ãƒ‰ç™ºè¦‹ã€åˆ†å‰²
â– â– â– â– â–¡â–¡â–¡â–¡
â– â– â– â– â–¡â–¡â–¡â–¡
â–¡â–¡â–¡â–¡â– â– â– â– 
â–¡â–¡â–¡â–¡â– â– â– â– 

ã‚¹ãƒ†ãƒƒãƒ—3ï¼šã•ã‚‰ã«åˆ†å‰²
â– â– â–¡â–¡â–¡â–¡â–¡â–¡
â–¡â–¡â– â– â–¡â–¡â–¡â–¡
â–¡â–¡â–¡â–¡â– â– â–¡â–¡
â–¡â–¡â–¡â–¡â–¡â–¡â– â– 

æœ€çµ‚ï¼šãƒ‘ã‚¹ãŒå®Œæˆï¼
```

### 7-2. ãƒ¡ãƒ¢ãƒªä½¿ç”¨ã®æ¨ç§»

```python
def visualize_memory_usage():
    """ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®å¯è¦–åŒ–"""

    # é€šå¸¸ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
    # â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  (100%)

    # Hirschbergã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
    # â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡ (6.25%)

    print("åŠ‡çš„ãªå‰Šæ¸›ï¼")
```

## ğŸ’¡ ã‚¹ãƒ†ãƒƒãƒ—8ï¼šã¾ã¨ã‚

### ãƒ¬ãƒ™ãƒ«1ï¼šåŸºç¤ç†è§£

```
å­¦ã‚“ã ã“ã¨ï¼š
1. ãƒ¡ãƒ¢ãƒªãŒãƒœãƒˆãƒ«ãƒãƒƒã‚¯
2. ä¸­é–“ãƒãƒ¼ãƒ‰ã§åˆ†å‰²çµ±æ²»
3. ç·šå½¢ç©ºé–“ã§ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆå¯èƒ½
```

### ãƒ¬ãƒ™ãƒ«2ï¼šå¿œç”¨ç†è§£

```
ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã“ã¨ï¼š
1. å·¨å¤§é…åˆ—ã®æ¯”è¼ƒ
2. ãƒ¡ãƒ¢ãƒªåˆ¶é™ç’°å¢ƒã§ã®å‹•ä½œ
3. å®Ÿç”¨çš„ãªé…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
```

### ãƒ¬ãƒ™ãƒ«3ï¼šå®Ÿè£…ç†è§£

```python
# å®Œå…¨ãªHirschbergã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
def hirschberg_alignment(v, w):
    """
    æ™‚é–“è¨ˆç®—é‡: O(mn)
    ç©ºé–“è¨ˆç®—é‡: O(min(m,n))

    é­”æ³•ã®ã‚ˆã†ãªåŠ¹ç‡æ€§ï¼
    """
    # çŸ­ã„æ–¹ã‚’è¡Œã«é…ç½®ï¼ˆã•ã‚‰ãªã‚‹æœ€é©åŒ–ï¼‰
    if len(v) > len(w):
        v, w = w, v
        swap = True
    else:
        swap = False

    # Hirschbergã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè¡Œ
    alignment = hirschberg_recursive(v, w)

    # å¿…è¦ãªã‚‰çµæœã‚’å…¥ã‚Œæ›¿ãˆ
    if swap:
        alignment = [(b, a) for a, b in alignment]

    return alignment

def hirschberg_recursive(v, w):
    """å†å¸°çš„ãªåˆ†å‰²çµ±æ²»"""
    m, n = len(v), len(w)

    # ãƒ™ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
    if m == 0:
        return [('-', w[j]) for j in range(n)]
    if n == 0:
        return [(v[i], '-') for i in range(m)]
    if m == 1 or n == 1:
        return simple_alignment(v, w)

    # åˆ†å‰²çµ±æ²»
    mid_col = n // 2

    # å‰æ–¹ã‚¹ã‚³ã‚¢ã¨å¾Œæ–¹ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—
    score_left = nw_score(v, w[:mid_col], gap_penalty)
    score_right = nw_score(v[::-1], w[mid_col:][::-1], gap_penalty)[::-1]

    # æœ€é©ãªåˆ†å‰²ç‚¹ã‚’è¦‹ã¤ã‘ã‚‹
    max_score = float('-inf')
    mid_row = 0
    for i in range(m + 1):
        score = score_left[i] + score_right[i]
        if score > max_score:
            max_score = score
            mid_row = i

    # å†å¸°çš„ã«ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
    align_left = hirschberg_recursive(v[:mid_row], w[:mid_col])
    align_right = hirschberg_recursive(v[mid_row:], w[mid_col:])

    return align_left + align_right
```

## ğŸš€ æ¬¡å›äºˆå‘Š

æ¬¡å›ã¯ã€Œå¤šé‡é…åˆ—ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã€ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚2ã¤ã§ã¯ãªãã€æ•°åã€œæ•°ç™¾ã®é…åˆ—ã‚’åŒæ™‚ã«æ¯”è¼ƒã™ã‚‹æ–¹æ³•ã¨ã¯ï¼Ÿã€€è¨ˆç®—è¤‡é›‘æ€§ã®çˆ†ç™ºã¨ãã®å¯¾å‡¦æ³•ã‚’æ¢ã‚Šã¾ã™ï¼

---

_ãƒ¡ãƒ¢ãƒªã®å£ã‚’è¶Šãˆã¦ã€çœŸã«å®Ÿç”¨çš„ãªã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã¸ï¼_
